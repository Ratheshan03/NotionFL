2024-04-07 04:28:45,163 - INFO - 
Training client 0 model...
2024-04-07 04:29:05,153 - INFO - Epoch 1/3, Loss: 0.7149
2024-04-07 04:29:26,379 - INFO - Epoch 2/3, Loss: 0.3616
2024-04-07 04:29:49,129 - INFO - Epoch 3/3, Loss: 0.2923
2024-04-07 04:29:49,259 - INFO - Training logs saved successfully for client_0 in DB.
2024-04-07 04:29:49,259 - INFO - 
Evaluating client 0 model...
2024-04-07 04:29:52,875 - INFO - Test set: Loss: 0.1710, Accuracy: 0.9480, Precision: 0.9485, Recall: 0.9480, F1: 0.9479
2024-04-07 04:29:52,875 - INFO - Confusion Matrix:
[[ 965    0    1    1    0    3    8    1    1    0]
 [   0 1117    5    3    1    0    4    1    4    0]
 [  11    1  963    6   14    1   11   17    7    1]
 [   1    0   15  956    1    7    1   15    7    7]
 [   0    0    2    0  959    0    9    2    1    9]
 [   7    1    3   22    4  829   13    2    4    7]
 [   6    3    1    2    7    9  929    0    1    0]
 [   3    5   15    2    9    0    0  965    0   29]
 [   3    3    6   17   19   13    6   18  869   20]
 [   6    5    0    9   45    6    1    7    2  928]]
2024-04-07 04:29:52,998 - INFO - Evaluation logs saved successfully for client_0 for round 0 in DB.
2024-04-07 04:29:54,488 - INFO - Client model saved for client_0 in DB.
2024-04-07 04:29:58,376 - INFO - Update for client_0 saved in DB.
FigureCanvasAgg is non-interactive, and thus cannot be shown
2024-04-07 04:30:25,649 - INFO - Model evaluation saved for client_0 in DB.
2024-04-07 04:30:25,650 - INFO - 
Adding differential privacy for client_0's round 0 model

FL Training Round 1/1
Traceback (most recent call last):
  File "C:\Users\prash\AppData\Local\Programs\Python\Python310\lib\site-packages\mongoengine\document.py", line 429, in save
    object_id, created = self._save_update(
  File "C:\Users\prash\AppData\Local\Programs\Python\Python310\lib\site-packages\mongoengine\document.py", line 549, in _save_update
    last_error = wc_collection.update_one(
  File "C:\Users\prash\AppData\Local\Programs\Python\Python310\lib\site-packages\pymongo\collection.py", line 1086, in update_one
    self._update_retryable(
  File "C:\Users\prash\AppData\Local\Programs\Python\Python310\lib\site-packages\pymongo\collection.py", line 881, in _update_retryable
    return self.__database.client._retryable_write(
  File "C:\Users\prash\AppData\Local\Programs\Python\Python310\lib\site-packages\pymongo\mongo_client.py", line 1523, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk)
  File "C:\Users\prash\AppData\Local\Programs\Python\Python310\lib\site-packages\pymongo\mongo_client.py", line 1421, in _retry_with_session
    return self._retry_internal(
  File "C:\Users\prash\AppData\Local\Programs\Python\Python310\lib\site-packages\pymongo\_csot.py", line 107, in csot_wrapper
    return func(self, *args, **kwargs)
  File "C:\Users\prash\AppData\Local\Programs\Python\Python310\lib\site-packages\pymongo\mongo_client.py", line 1462, in _retry_internal
    ).run()
  File "C:\Users\prash\AppData\Local\Programs\Python\Python310\lib\site-packages\pymongo\mongo_client.py", line 2315, in run
    return self._read() if self._is_read else self._write()
  File "C:\Users\prash\AppData\Local\Programs\Python\Python310\lib\site-packages\pymongo\mongo_client.py", line 2423, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
  File "C:\Users\prash\AppData\Local\Programs\Python\Python310\lib\site-packages\pymongo\collection.py", line 862, in _update
    return self._update(
  File "C:\Users\prash\AppData\Local\Programs\Python\Python310\lib\site-packages\pymongo\collection.py", line 825, in _update
    _check_write_command_response(result)
  File "C:\Users\prash\AppData\Local\Programs\Python\Python310\lib\site-packages\pymongo\helpers.py", line 266, in _check_write_command_response
    _raise_last_write_error(write_errors)
  File "C:\Users\prash\AppData\Local\Programs\Python\Python310\lib\site-packages\pymongo\helpers.py", line 239, in _raise_last_write_error
    raise WriteError(error.get("errmsg"), error.get("code"), error)
pymongo.errors.WriteError: BSONObj size: 20189494 (0x1341136) is invalid. Size must be between 0 and 16793600(16MB) First element: _id: ObjectId('6611d39fe12dfed02bbf0fc2'), full error: {'index': 0, 'code': 10334, 'errmsg': "BSONObj size: 20189494 (0x1341136) is invalid. Size must be between 0 and 16793600(16MB) First element: _id: ObjectId('6611d39fe12dfed02bbf0fc2')"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Rathe\Final Year\FYP\Implementation\NotionFL\notionfl-be\main.py", line 231, in <module>
    main(training_id)
  File "D:\Rathe\Final Year\FYP\Implementation\NotionFL\notionfl-be\main.py", line 114, in main
    data_collector.collect_client_model(client.client_id, private_model_state, round, suffix='private')
  File "D:\Rathe\Final Year\FYP\Implementation\NotionFL\notionfl-be\utils\data_collector.py", line 164, in collect_client_model
    training_session.save()
  File "C:\Users\prash\AppData\Local\Programs\Python\Python310\lib\site-packages\mongoengine\document.py", line 458, in save
    raise OperationError(message % err)
mongoengine.errors.OperationError: Could not save document (BSONObj size: 20189494 (0x1341136) is invalid. Size must be between 0 and 16793600(16MB) First element: _id: ObjectId('6611d39fe12dfed02bbf0fc2'), full error: {'index': 0, 'code': 10334, 'errmsg': "BSONObj size: 20189494 (0x1341136) is invalid. Size must be between 0 and 16793600(16MB) First element: _id: ObjectId('6611d39fe12dfed02bbf0fc2')"})
