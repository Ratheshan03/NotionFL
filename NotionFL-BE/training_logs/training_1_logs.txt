FigureCanvasAgg is non-interactive, and thus cannot be shown
FigureCanvasAgg is non-interactive, and thus cannot be shown
FigureCanvasAgg is non-interactive, and thus cannot be shown

FL Training Round 1/1

Training client 0 model...
Epoch 1/2, Loss: 0.9715
Epoch 2/2, Loss: 0.3993

Evaluating client 0 model...
Test set: Loss: 0.2521, Accuracy: 0.9250, Precision: 0.9268, Recall: 0.9250, F1: 0.9245
Confusion Matrix:
[[ 966    0    0    0    0    2    7    2    3    0]
 [   0 1125    2    2    0    1    4    0    1    0]
 [  17   11  923   18   15    0   16   16   15    1]
 [   4    3   12  956    0    5    5   10   12    3]
 [   1    6    5    0  932    0   17    1    2   18]
 [  22    4    0   65    4  732   31    3   24    7]
 [  14    4    2    2    6    5  925    0    0    0]
 [   5   23   17    8    8    0    0  945    2   20]
 [  12   19    4   32    7    8   16    8  860    8]
 [  15   11    0   19   57    2    1   11    7  886]]

Training client 1 model...
Epoch 1/2, Loss: 0.3473
Epoch 2/2, Loss: 0.3013

Evaluating client 1 model...
Test set: Loss: 0.1778, Accuracy: 0.9468, Precision: 0.9476, Recall: 0.9468, F1: 0.9468
Confusion Matrix:
[[ 966    0    1    2    0    3    3    1    4    0]
 [   0 1123    4    2    0    0    3    0    3    0]
 [  11    4  957   19    9    0    7   12   12    1]
 [   0    1    6  973    0    6    1    9   10    4]
 [   1    3    3    0  925    0   10    2    2   36]
 [   4    2    1   51    5  797    7    3   15    7]
 [  13    4    2    2    6   14  916    0    1    0]
 [   1   11   16    7    1    0    0  968    0   24]
 [   5    5    3   30    9    4    7   11  893    7]
 [   9    6    0   17   13    3    1    6    4  950]]

Training client 2 model...
Epoch 1/2, Loss: 0.2661
Epoch 2/2, Loss: 0.2415

Evaluating client 2 model...
Test set: Loss: 0.1423, Accuracy: 0.9580, Precision: 0.9583, Recall: 0.9580, F1: 0.9579
Confusion Matrix:
[[ 963    0    1    1    0    2    9    1    3    0]
 [   0 1127    3    1    0    0    3    0    1    0]
 [   6    8  985   11    6    1    3    7    4    1]
 [   0    2    9  968    0   15    0    7    8    1]
 [   0    1    5    0  955    0    7    1    2   11]
 [   3    2    0   12    3  854   10    1    2    5]
 [   7    4    0    1    6    9  931    0    0    0]
 [   1   10   18    1    4    0    0  983    0   11]
 [   4   12    9   23    7   21   12   10  870    6]
 [   7    8    1   15   18    8    1    6    1  944]]
Aggregation explanation for round 0 saved successfully.
Global Model Test set: Average loss: 0.1423, Accuracy: 0.9580
Precision: 0.9583, Recall: 0.9580, F1 Score: 0.9579
Confusion Matrix:
[[ 963    0    1    1    0    2    9    1    3    0]
 [   0 1127    3    1    0    0    3    0    1    0]
 [   6    8  985   11    6    1    3    7    4    1]
 [   0    2    9  968    0   15    0    7    8    1]
 [   0    1    5    0  955    0    7    1    2   11]
 [   3    2    0   12    3  854   10    1    2    5]
 [   7    4    0    1    6    9  931    0    0    0]
 [   1   10   18    1    4    0    0  983    0   11]
 [   4   12    9   23    7   21   12   10  870    6]
 [   7    8    1   15   18    8    1    6    1  944]]
Global Model Test set: Average loss: 0.1423, Accuracy: 0.9580
Precision: 0.9583, Recall: 0.9580, F1 Score: 0.9579
Confusion Matrix:
[[ 963    0    1    1    0    2    9    1    3    0]
 [   0 1127    3    1    0    0    3    0    1    0]
 [   6    8  985   11    6    1    3    7    4    1]
 [   0    2    9  968    0   15    0    7    8    1]
 [   0    1    5    0  955    0    7    1    2   11]
 [   3    2    0   12    3  854   10    1    2    5]
 [   7    4    0    1    6    9  931    0    0    0]
 [   1   10   18    1    4    0    0  983    0   11]
 [   4   12    9   23    7   21   12   10  870    6]
 [   7    8    1   15   18    8    1    6    1  944]]
Global Model Test set: Average loss: 0.1423, Accuracy: 0.9580
Precision: 0.9583, Recall: 0.9580, F1 Score: 0.9579
Confusion Matrix:
[[ 963    0    1    1    0    2    9    1    3    0]
 [   0 1127    3    1    0    0    3    0    1    0]
 [   6    8  985   11    6    1    3    7    4    1]
 [   0    2    9  968    0   15    0    7    8    1]
 [   0    1    5    0  955    0    7    1    2   11]
 [   3    2    0   12    3  854   10    1    2    5]
 [   7    4    0    1    6    9  931    0    0    0]
 [   1   10   18    1    4    0    0  983    0   11]
 [   4   12    9   23    7   21   12   10  870    6]
 [   7    8    1   15   18    8    1    6    1  944]]
Global Model Test set: Average loss: 0.2868, Accuracy: 0.9138
Precision: 0.9174, Recall: 0.9138, F1 Score: 0.9137
Confusion Matrix:
[[ 952    0    0    0    0    7   13    1    7    0]
 [   0 1096    3    2    1    2    4    1   26    0]
 [   9    2  899    8   10    1   30   11   60    2]
 [   6    1   28  803    0   87    4   16   58    7]
 [   0    1    6    0  908    2   27    2    9   27]
 [   6    2    0    8    6  813   26    3   25    3]
 [   7    3    2    1    4   12  924    1    4    0]
 [   2    8   22    1    8    1    0  948   15   23]
 [   4    1    2    3    6   13    8    9  924    4]
 [  11    5    5    6   58   11    1   22   19  871]]
Global Model Test set: Average loss: 1.2740, Accuracy: 0.8890
Precision: 0.9010, Recall: 0.8890, F1 Score: 0.8906
Confusion Matrix:
[[ 816    0   10   11    5   99    8    3   28    0]
 [   0 1094    2    6    1    5    0    0   27    0]
 [   1    2  920   23   33   10    1   12   30    0]
 [   0    1    4  883    3   74    0   11   29    5]
 [   0    0    4    0  957    1    1    1    4   14]
 [   1    1    2   33   15  820    2    1   14    3]
 [   7    3    7    1   72   54  783    1   30    0]
 [   0    9   25    5   14    1    0  954    4   16]
 [   2    2    1   19   20   60    0    7  854    9]
 [   2    4    7   10  110   30    0   33    4  809]]
Global Model Test set: Average loss: 0.2222, Accuracy: 0.9356
Precision: 0.9359, Recall: 0.9356, F1 Score: 0.9355
Confusion Matrix:
[[ 960    0    0    2    0    4    8    1    5    0]
 [   0 1108    3    2    1    1    4    1   15    0]
 [  11    2  922   15   14    0   16   15   36    1]
 [   3    1   11  928    0   25    3   12   19    8]
 [   0    1    5    0  930    0   16    4    3   23]
 [   7    1    0   21    7  820   15    3   14    4]
 [   9    3    1    3    6   16  917    1    2    0]
 [   2    7   18    3    6    0    0  968    5   19]
 [   5    3    2   14    7   12    7   11  907    6]
 [  12    6    2   16   40    4    1   25    7  896]]
Global Model Test set: Average loss: 0.2187, Accuracy: 0.9362
Precision: 0.9379, Recall: 0.9362, F1 Score: 0.9362
Confusion Matrix:
[[ 971    0    1    2    0    2    2    1    1    0]
 [   0 1110    1    6    1    0    4    2   11    0]
 [  12    1  908   34   16    0    9   21   29    2]
 [   0    0    1  975    0    8    0    9    8    9]
 [   1    0    4    0  943    0    7    2    3   22]
 [  10    1    0   35    4  813    9    5   11    4]
 [  15    4    1    4    7   16  906    2    3    0]
 [   1    6   12   12    5    0    0  975    1   16]
 [   5    5    1   60    9   15    6   13  851    9]
 [  10    6    0   19   37    3    1   21    2  910]]
Global Model Test set: Average loss: 1.2900, Accuracy: 0.8516
Precision: 0.8916, Recall: 0.8516, F1 Score: 0.8579
Confusion Matrix:
[[ 715    0    9   16    8  203    9    7   13    0]
 [   0 1108    2    5    1    9    0    1    9    0]
 [   1    4  931   27   29   17    0    7   16    0]
 [   0    1    8  827    2  146    0   13   11    2]
 [   0    0    3    0  963    3    2    1    4    6]
 [   0    0    0   19    9  858    1    1    3    1]
 [   3    3    5    1   62  149  702    1   32    0]
 [   0    7   26    8   14   10    0  955    2    6]
 [   0    2    3   17   14  219    0    5  712    2]
 [   0    5    5    5  145   60    0   43    1  745]]
Global Model Test set: Average loss: 0.1423, Accuracy: 0.9580
Precision: 0.9583, Recall: 0.9580, F1 Score: 0.9579
FigureCanvasAgg is non-interactive, and thus cannot be shown
Confusion Matrix:
[[ 963    0    1    1    0    2    9    1    3    0]
 [   0 1127    3    1    0    0    3    0    1    0]
 [   6    8  985   11    6    1    3    7    4    1]
 [   0    2    9  968    0   15    0    7    8    1]
 [   0    1    5    0  955    0    7    1    2   11]
 [   3    2    0   12    3  854   10    1    2    5]
 [   7    4    0    1    6    9  931    0    0    0]
 [   1   10   18    1    4    0    0  983    0   11]
 [   4   12    9   23    7   21   12   10  870    6]
 [   7    8    1   15   18    8    1    6    1  944]]
Global Model Test set: Average loss: 1.0083, Accuracy: 0.9089
Precision: 0.9163, Recall: 0.9089, F1 Score: 0.9098
Confusion Matrix:
[[ 911    0    3    5    7   35    9    5    5    0]
 [   0 1105    3    4    1    7    0    1   14    0]
 [   3    3  939   13   28   10    7   10   19    0]
 [   0    1   16  873    2   80    0   12   19    7]
 [   0    0    4    0  954    2    5    2    5   10]
 [   3    0    1   15    9  848    4    2    8    2]
 [   4    3    2    2   31   51  850    1   14    0]
 [   0    7   31    4   10    1    0  959    3   13]
 [   3    2    3   20   12   83    0   10  838    3]
 [   3    5    9   10   82   35    0   47    6  812]]
Global Model Test set: Average loss: 1.3051, Accuracy: 0.8498
Precision: 0.8824, Recall: 0.8498, F1 Score: 0.8511
Confusion Matrix:
[[ 816    0    4   28    7  104   11    9    1    0]
 [   0 1099    2   20    1    6    0    1    6    0]
 [   1    0  939   34   30   15    1    9    3    0]
 [   0    0    9  913    3   72    0   12    1    0]
 [   0    0    2    0  964    3    2    2    2    7]
 [   1    0    0   28   11  839    5    3    4    1]
 [   3    3    4    4   54  122  752    1   15    0]
 [   0    4   34   19   12    1    0  950    1    7]
 [   3    2    7  111   16  259    0    3  571    2]
 [   0    2    5   19  144   61    0  122    1  655]]
Global Model Test set: Average loss: 0.2187, Accuracy: 0.9362
Precision: 0.9379, Recall: 0.9362, F1 Score: 0.9362
Confusion Matrix:
[[ 971    0    1    2    0    2    2    1    1    0]
 [   0 1110    1    6    1    0    4    2   11    0]
 [  12    1  908   34   16    0    9   21   29    2]
 [   0    0    1  975    0    8    0    9    8    9]
 [   1    0    4    0  943    0    7    2    3   22]
 [  10    1    0   35    4  813    9    5   11    4]
 [  15    4    1    4    7   16  906    2    3    0]
 [   1    6   12   12    5    0    0  975    1   16]
 [   5    5    1   60    9   15    6   13  851    9]
 [  10    6    0   19   37    3    1   21    2  910]]
Global Model Test set: Average loss: 1.2740, Accuracy: 0.8890
Precision: 0.9010, Recall: 0.8890, F1 Score: 0.8906
Confusion Matrix:
[[ 816    0   10   11    5   99    8    3   28    0]
 [   0 1094    2    6    1    5    0    0   27    0]
 [   1    2  920   23   33   10    1   12   30    0]
 [   0    1    4  883    3   74    0   11   29    5]
 [   0    0    4    0  957    1    1    1    4   14]
 [   1    1    2   33   15  820    2    1   14    3]
 [   7    3    7    1   72   54  783    1   30    0]
 [   0    9   25    5   14    1    0  954    4   16]
 [   2    2    1   19   20   60    0    7  854    9]
 [   2    4    7   10  110   30    0   33    4  809]]
Global Model Test set: Average loss: 0.2222, Accuracy: 0.9356
Precision: 0.9359, Recall: 0.9356, F1 Score: 0.9355
Confusion Matrix:
[[ 960    0    0    2    0    4    8    1    5    0]
 [   0 1108    3    2    1    1    4    1   15    0]
 [  11    2  922   15   14    0   16   15   36    1]
 [   3    1   11  928    0   25    3   12   19    8]
 [   0    1    5    0  930    0   16    4    3   23]
 [   7    1    0   21    7  820   15    3   14    4]
 [   9    3    1    3    6   16  917    1    2    0]
 [   2    7   18    3    6    0    0  968    5   19]
 [   5    3    2   14    7   12    7   11  907    6]
 [  12    6    2   16   40    4    1   25    7  896]]
Global Model Test set: Average loss: 0.2868, Accuracy: 0.9138
Precision: 0.9174, Recall: 0.9138, F1 Score: 0.9137
Confusion Matrix:
[[ 952    0    0    0    0    7   13    1    7    0]
 [   0 1096    3    2    1    2    4    1   26    0]
 [   9    2  899    8   10    1   30   11   60    2]
 [   6    1   28  803    0   87    4   16   58    7]
 [   0    1    6    0  908    2   27    2    9   27]
 [   6    2    0    8    6  813   26    3   25    3]
 [   7    3    2    1    4   12  924    1    4    0]
 [   2    8   22    1    8    1    0  948   15   23]
 [   4    1    2    3    6   13    8    9  924    4]
 [  11    5    5    6   58   11    1   22   19  871]]
Global Model Test set: Average loss: 1.3051, Accuracy: 0.8498
Precision: 0.8824, Recall: 0.8498, F1 Score: 0.8511
Confusion Matrix:
[[ 816    0    4   28    7  104   11    9    1    0]
 [   0 1099    2   20    1    6    0    1    6    0]
 [   1    0  939   34   30   15    1    9    3    0]
 [   0    0    9  913    3   72    0   12    1    0]
 [   0    0    2    0  964    3    2    2    2    7]
 [   1    0    0   28   11  839    5    3    4    1]
 [   3    3    4    4   54  122  752    1   15    0]
 [   0    4   34   19   12    1    0  950    1    7]
 [   3    2    7  111   16  259    0    3  571    2]
 [   0    2    5   19  144   61    0  122    1  655]]
Global Model Test set: Average loss: 0.1423, Accuracy: 0.9580
Precision: 0.9583, Recall: 0.9580, F1 Score: 0.9579
Confusion Matrix:
[[ 963    0    1    1    0    2    9    1    3    0]
 [   0 1127    3    1    0    0    3    0    1    0]
 [   6    8  985   11    6    1    3    7    4    1]
 [   0    2    9  968    0   15    0    7    8    1]
 [   0    1    5    0  955    0    7    1    2   11]
 [   3    2    0   12    3  854   10    1    2    5]
 [   7    4    0    1    6    9  931    0    0    0]
 [   1   10   18    1    4    0    0  983    0   11]
 [   4   12    9   23    7   21   12   10  870    6]
 [   7    8    1   15   18    8    1    6    1  944]]
Global Model Test set: Average loss: 1.0083, Accuracy: 0.9089
Precision: 0.9163, Recall: 0.9089, F1 Score: 0.9098
Confusion Matrix:
[[ 911    0    3    5    7   35    9    5    5    0]
 [   0 1105    3    4    1    7    0    1   14    0]
 [   3    3  939   13   28   10    7   10   19    0]
 [   0    1   16  873    2   80    0   12   19    7]
 [   0    0    4    0  954    2    5    2    5   10]
 [   3    0    1   15    9  848    4    2    8    2]
 [   4    3    2    2   31   51  850    1   14    0]
 [   0    7   31    4   10    1    0  959    3   13]
 [   3    2    3   20   12   83    0   10  838    3]
 [   3    5    9   10   82   35    0   47    6  812]]
Global Model Test set: Average loss: 1.2900, Accuracy: 0.8516
Precision: 0.8916, Recall: 0.8516, F1 Score: 0.8579
Confusion Matrix:
[[ 715    0    9   16    8  203    9    7   13    0]
 [   0 1108    2    5    1    9    0    1    9    0]
 [   1    4  931   27   29   17    0    7   16    0]
 [   0    1    8  827    2  146    0   13   11    2]
 [   0    0    3    0  963    3    2    1    4    6]
 [   0    0    0   19    9  858    1    1    3    1]
 [   3    3    5    1   62  149  702    1   32    0]
 [   0    7   26    8   14   10    0  955    2    6]
 [   0    2    3   17   14  219    0    5  712    2]
 [   0    5    5    5  145   60    0   43    1  745]]
Global Model Test set: Average loss: 0.1423, Accuracy: 0.9580
Precision: 0.9583, Recall: 0.9580, F1 Score: 0.9579
Confusion Matrix:
[[ 963    0    1    1    0    2    9    1    3    0]
 [   0 1127    3    1    0    0    3    0    1    0]
 [   6    8  985   11    6    1    3    7    4    1]
 [   0    2    9  968    0   15    0    7    8    1]
 [   0    1    5    0  955    0    7    1    2   11]
 [   3    2    0   12    3  854   10    1    2    5]
 [   7    4    0    1    6    9  931    0    0    0]
 [   1   10   18    1    4    0    0  983    0   11]
 [   4   12    9   23    7   21   12   10  870    6]
 [   7    8    1   15   18    8    1    6    1  944]]
Global Model Test set: Average loss: 1.2740, Accuracy: 0.8890
Precision: 0.9010, Recall: 0.8890, F1 Score: 0.8906
Confusion Matrix:
[[ 816    0   10   11    5   99    8    3   28    0]
 [   0 1094    2    6    1    5    0    0   27    0]
 [   1    2  920   23   33   10    1   12   30    0]
 [   0    1    4  883    3   74    0   11   29    5]
 [   0    0    4    0  957    1    1    1    4   14]
 [   1    1    2   33   15  820    2    1   14    3]
 [   7    3    7    1   72   54  783    1   30    0]
 [   0    9   25    5   14    1    0  954    4   16]
 [   2    2    1   19   20   60    0    7  854    9]
 [   2    4    7   10  110   30    0   33    4  809]]
Global Model Test set: Average loss: 1.2900, Accuracy: 0.8516
Precision: 0.8916, Recall: 0.8516, F1 Score: 0.8579
Confusion Matrix:
[[ 715    0    9   16    8  203    9    7   13    0]
 [   0 1108    2    5    1    9    0    1    9    0]
 [   1    4  931   27   29   17    0    7   16    0]
 [   0    1    8  827    2  146    0   13   11    2]
 [   0    0    3    0  963    3    2    1    4    6]
 [   0    0    0   19    9  858    1    1    3    1]
 [   3    3    5    1   62  149  702    1   32    0]
 [   0    7   26    8   14   10    0  955    2    6]
 [   0    2    3   17   14  219    0    5  712    2]
 [   0    5    5    5  145   60    0   43    1  745]]
Global Model Test set: Average loss: 0.2868, Accuracy: 0.9138
Precision: 0.9174, Recall: 0.9138, F1 Score: 0.9137
Confusion Matrix:
[[ 952    0    0    0    0    7   13    1    7    0]
 [   0 1096    3    2    1    2    4    1   26    0]
 [   9    2  899    8   10    1   30   11   60    2]
 [   6    1   28  803    0   87    4   16   58    7]
 [   0    1    6    0  908    2   27    2    9   27]
 [   6    2    0    8    6  813   26    3   25    3]
 [   7    3    2    1    4   12  924    1    4    0]
 [   2    8   22    1    8    1    0  948   15   23]
 [   4    1    2    3    6   13    8    9  924    4]
 [  11    5    5    6   58   11    1   22   19  871]]
Global Model Test set: Average loss: 1.3051, Accuracy: 0.8498
Precision: 0.8824, Recall: 0.8498, F1 Score: 0.8511
Confusion Matrix:
[[ 816    0    4   28    7  104   11    9    1    0]
 [   0 1099    2   20    1    6    0    1    6    0]
 [   1    0  939   34   30   15    1    9    3    0]
 [   0    0    9  913    3   72    0   12    1    0]
 [   0    0    2    0  964    3    2    2    2    7]
 [   1    0    0   28   11  839    5    3    4    1]
 [   3    3    4    4   54  122  752    1   15    0]
 [   0    4   34   19   12    1    0  950    1    7]
 [   3    2    7  111   16  259    0    3  571    2]
 [   0    2    5   19  144   61    0  122    1  655]]
Global Model Test set: Average loss: 0.2187, Accuracy: 0.9362
Precision: 0.9379, Recall: 0.9362, F1 Score: 0.9362
Confusion Matrix:
[[ 971    0    1    2    0    2    2    1    1    0]
 [   0 1110    1    6    1    0    4    2   11    0]
 [  12    1  908   34   16    0    9   21   29    2]
 [   0    0    1  975    0    8    0    9    8    9]
 [   1    0    4    0  943    0    7    2    3   22]
 [  10    1    0   35    4  813    9    5   11    4]
 [  15    4    1    4    7   16  906    2    3    0]
 [   1    6   12   12    5    0    0  975    1   16]
 [   5    5    1   60    9   15    6   13  851    9]
 [  10    6    0   19   37    3    1   21    2  910]]
Global Model Test set: Average loss: 1.0083, Accuracy: 0.9089
Precision: 0.9163, Recall: 0.9089, F1 Score: 0.9098
Confusion Matrix:
[[ 911    0    3    5    7   35    9    5    5    0]
 [   0 1105    3    4    1    7    0    1   14    0]
 [   3    3  939   13   28   10    7   10   19    0]
 [   0    1   16  873    2   80    0   12   19    7]
 [   0    0    4    0  954    2    5    2    5   10]
 [   3    0    1   15    9  848    4    2    8    2]
 [   4    3    2    2   31   51  850    1   14    0]
 [   0    7   31    4   10    1    0  959    3   13]
 [   3    2    3   20   12   83    0   10  838    3]
 [   3    5    9   10   82   35    0   47    6  812]]
Global Model Test set: Average loss: 0.2222, Accuracy: 0.9356
Precision: 0.9359, Recall: 0.9356, F1 Score: 0.9355
Confusion Matrix:
[[ 960    0    0    2    0    4    8    1    5    0]
 [   0 1108    3    2    1    1    4    1   15    0]
 [  11    2  922   15   14    0   16   15   36    1]
 [   3    1   11  928    0   25    3   12   19    8]
 [   0    1    5    0  930    0   16    4    3   23]
 [   7    1    0   21    7  820   15    3   14    4]
 [   9    3    1    3    6   16  917    1    2    0]
 [   2    7   18    3    6    0    0  968    5   19]
 [   5    3    2   14    7   12    7   11  907    6]
 [  12    6    2   16   40    4    1   25    7  896]]
Shapley Values for round 1: {0: 0.010133333333333326, 1: 0.02043333333333336, 2: -0.010666666666666656}
Incentives allocated: {'0': 5092.1273031825685, '1': 10268.006700167502, '2': -5360.134003350071}
Comparing client 0 and global model shap values
Comparing client 1 and global model shap values
Comparing client 2 and global model shap values
