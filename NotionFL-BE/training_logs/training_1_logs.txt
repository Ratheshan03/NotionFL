FigureCanvasAgg is non-interactive, and thus cannot be shown
FigureCanvasAgg is non-interactive, and thus cannot be shown
FigureCanvasAgg is non-interactive, and thus cannot be shown

FL Training Round 1/1

Training client 0 model...
Epoch 1/3, Loss: 0.7374
Epoch 2/3, Loss: 0.3514
Epoch 3/3, Loss: 0.2815

Evaluating client 0 model...
Test set: Loss: 0.1669, Accuracy: 0.9505, Precision: 0.9507, Recall: 0.9505, F1: 0.9503
Confusion Matrix:
[[ 966    0    1    1    0    2    6    1    3    0]
 [   0 1122    3    3    0    0    4    1    2    0]
 [   7    2  984    7    3    0    6   14    9    0]
 [   0    1   21  947    0    5    2   21   10    3]
 [   1    1    5    0  932    0   10    3    2   28]
 [   7    1    1   23    4  813   19    5   12    7]
 [   8    3    3    1    5    4  934    0    0    0]
 [   1    8   17    0    2    0    0  991    1    8]
 [   9    5    8   14    8   12   16   20  871   11]
 [   9    6    1   10   18    2    0   14    4  945]]

Training client 1 model...
Epoch 1/3, Loss: 0.2590
Epoch 2/3, Loss: 0.2213
Epoch 3/3, Loss: 0.1945

Evaluating client 1 model...
Test set: Loss: 0.1043, Accuracy: 0.9693, Precision: 0.9694, Recall: 0.9693, F1: 0.9693
Confusion Matrix:
[[ 968    0    1    1    0    2    5    1    2    0]
 [   0 1121    3    2    0    0    6    0    3    0]
 [   7    1  991    7    3    0    8    6    9    0]
 [   1    0    7  980    0    3    0    6   11    2]
 [   1    0    2    0  955    0   10    1    2   11]
 [   4    1    0    9    0  864    6    1    5    2]
 [   5    3    0    1    3    3  941    0    2    0]
 [   2    5   19    4    0    0    0  983    1   14]
 [   7    0    1    7    6    4    9    6  931    3]
 [   5    5    1    6   15    2    1    5   10  959]]
Aggregation explanation for round 0 saved successfully.
Global Model Test set: Average loss: 0.1043, Accuracy: 0.9693
Precision: 0.9694, Recall: 0.9693, F1 Score: 0.9693
Confusion Matrix:
[[ 968    0    1    1    0    2    5    1    2    0]
 [   0 1121    3    2    0    0    6    0    3    0]
 [   7    1  991    7    3    0    8    6    9    0]
 [   1    0    7  980    0    3    0    6   11    2]
 [   1    0    2    0  955    0   10    1    2   11]
 [   4    1    0    9    0  864    6    1    5    2]
 [   5    3    0    1    3    3  941    0    2    0]
 [   2    5   19    4    0    0    0  983    1   14]
 [   7    0    1    7    6    4    9    6  931    3]
 [   5    5    1    6   15    2    1    5   10  959]]
Global Model Test set: Average loss: 0.1043, Accuracy: 0.9693
Precision: 0.9694, Recall: 0.9693, F1 Score: 0.9693
Confusion Matrix:
[[ 968    0    1    1    0    2    5    1    2    0]
 [   0 1121    3    2    0    0    6    0    3    0]
 [   7    1  991    7    3    0    8    6    9    0]
 [   1    0    7  980    0    3    0    6   11    2]
 [   1    0    2    0  955    0   10    1    2   11]
 [   4    1    0    9    0  864    6    1    5    2]
 [   5    3    0    1    3    3  941    0    2    0]
 [   2    5   19    4    0    0    0  983    1   14]
 [   7    0    1    7    6    4    9    6  931    3]
 [   5    5    1    6   15    2    1    5   10  959]]
Global Model Test set: Average loss: 0.1043, Accuracy: 0.9693
Precision: 0.9694, Recall: 0.9693, F1 Score: 0.9693
Confusion Matrix:
[[ 968    0    1    1    0    2    5    1    2    0]
 [   0 1121    3    2    0    0    6    0    3    0]
 [   7    1  991    7    3    0    8    6    9    0]
 [   1    0    7  980    0    3    0    6   11    2]
 [   1    0    2    0  955    0   10    1    2   11]
 [   4    1    0    9    0  864    6    1    5    2]
 [   5    3    0    1    3    3  941    0    2    0]
 [   2    5   19    4    0    0    0  983    1   14]
 [   7    0    1    7    6    4    9    6  931    3]
 [   5    5    1    6   15    2    1    5   10  959]]
Global Model Test set: Average loss: 0.1669, Accuracy: 0.9505
Precision: 0.9507, Recall: 0.9505, F1 Score: 0.9503
Confusion Matrix:
[[ 966    0    1    1    0    2    6    1    3    0]
 [   0 1122    3    3    0    0    4    1    2    0]
 [   7    2  984    7    3    0    6   14    9    0]
 [   0    1   21  947    0    5    2   21   10    3]
 [   1    1    5    0  932    0   10    3    2   28]
 [   7    1    1   23    4  813   19    5   12    7]
 [   8    3    3    1    5    4  934    0    0    0]
 [   1    8   17    0    2    0    0  991    1    8]
 [   9    5    8   14    8   12   16   20  871   11]
 [   9    6    1   10   18    2    0   14    4  945]]
Global Model Test set: Average loss: 0.1689, Accuracy: 0.9473
Precision: 0.9479, Recall: 0.9473, F1 Score: 0.9473
Confusion Matrix:
[[ 958    0    0    0    0    2   15    1    4    0]
 [   0 1124    2    1    0    1    5    1    1    0]
 [  11    5  937   14    6    1   18   15   23    2]
 [   3    2    8  947    2   20    3    8   11    6]
 [   0    1    2    0  919    0   18    2    3   37]
 [   6    1    0   11    3  839   16    1    8    7]
 [   9    3    0    0    5    6  934    0    1    0]
 [   2   10   12    3    5    0    0  951    1   44]
 [   5    5    2   11    7   11   12    9  906    6]
 [   6    6    0   10   13    2    1    6    7  958]]
Global Model Test set: Average loss: 0.1255, Accuracy: 0.9635
Precision: 0.9636, Recall: 0.9635, F1 Score: 0.9635
Confusion Matrix:
[[ 965    0    1    1    0    2    6    1    4    0]
 [   0 1120    3    3    0    0    6    0    3    0]
 [   8    1  986    8    3    0    7    9   10    0]
 [   0    1    9  972    0    3    2    9   11    3]
 [   1    0    3    0  951    0   10    1    2   14]
 [   7    1    0   11    1  842   15    2    8    5]
 [   7    3    0    1    4    5  937    0    1    0]
 [   1    7   16    1    2    0    0  986    1   14]
 [   7    2    1    9    7    5   11    6  922    4]
 [   6    6    1    9   17    1    1    7    7  954]]
Global Model Test set: Average loss: 0.1043, Accuracy: 0.9693
Precision: 0.9694, Recall: 0.9693, F1 Score: 0.9693
Confusion Matrix:
[[ 968    0    1    1    0    2    5    1    2    0]
 [   0 1121    3    2    0    0    6    0    3    0]
 [   7    1  991    7    3    0    8    6    9    0]
 [   1    0    7  980    0    3    0    6   11    2]
 [   1    0    2    0  955    0   10    1    2   11]
 [   4    1    0    9    0  864    6    1    5    2]
 [   5    3    0    1    3    3  941    0    2    0]
 [   2    5   19    4    0    0    0  983    1   14]
 [   7    0    1    7    6    4    9    6  931    3]
 [   5    5    1    6   15    2    1    5   10  959]]
Global Model Test set: Average loss: 0.1043, Accuracy: 0.9693
Precision: 0.9694, Recall: 0.9693, F1 Score: 0.9693
Confusion Matrix:
[[ 968    0    1    1    0    2    5    1    2    0]
 [   0 1121    3    2    0    0    6    0    3    0]
 [   7    1  991    7    3    0    8    6    9    0]
 [   1    0    7  980    0    3    0    6   11    2]
 [   1    0    2    0  955    0   10    1    2   11]
 [   4    1    0    9    0  864    6    1    5    2]
 [   5    3    0    1    3    3  941    0    2    0]
 [   2    5   19    4    0    0    0  983    1   14]
 [   7    0    1    7    6    4    9    6  931    3]
 [   5    5    1    6   15    2    1    5   10  959]]
Global Model Test set: Average loss: 0.1689, Accuracy: 0.9473
Precision: 0.9479, Recall: 0.9473, F1 Score: 0.9473
Confusion Matrix:
[[ 958    0    0    0    0    2   15    1    4    0]
 [   0 1124    2    1    0    1    5    1    1    0]
 [  11    5  937   14    6    1   18   15   23    2]
 [   3    2    8  947    2   20    3    8   11    6]
 [   0    1    2    0  919    0   18    2    3   37]
 [   6    1    0   11    3  839   16    1    8    7]
 [   9    3    0    0    5    6  934    0    1    0]
 [   2   10   12    3    5    0    0  951    1   44]
 [   5    5    2   11    7   11   12    9  906    6]
 [   6    6    0   10   13    2    1    6    7  958]]
Global Model Test set: Average loss: 0.1255, Accuracy: 0.9635
Precision: 0.9636, Recall: 0.9635, F1 Score: 0.9635
Confusion Matrix:
[[ 965    0    1    1    0    2    6    1    4    0]
 [   0 1120    3    3    0    0    6    0    3    0]
 [   8    1  986    8    3    0    7    9   10    0]
 [   0    1    9  972    0    3    2    9   11    3]
 [   1    0    3    0  951    0   10    1    2   14]
 [   7    1    0   11    1  842   15    2    8    5]
 [   7    3    0    1    4    5  937    0    1    0]
 [   1    7   16    1    2    0    0  986    1   14]
 [   7    2    1    9    7    5   11    6  922    4]
 [   6    6    1    9   17    1    1    7    7  954]]
Global Model Test set: Average loss: 0.1669, Accuracy: 0.9505
Precision: 0.9507, Recall: 0.9505, F1 Score: 0.9503
Confusion Matrix:
[[ 966    0    1    1    0    2    6    1    3    0]
 [   0 1122    3    3    0    0    4    1    2    0]
 [   7    2  984    7    3    0    6   14    9    0]
 [   0    1   21  947    0    5    2   21   10    3]
 [   1    1    5    0  932    0   10    3    2   28]
 [   7    1    1   23    4  813   19    5   12    7]
 [   8    3    3    1    5    4  934    0    0    0]
 [   1    8   17    0    2    0    0  991    1    8]
 [   9    5    8   14    8   12   16   20  871   11]
 [   9    6    1   10   18    2    0   14    4  945]]
Shapley Values for round 1: {0: -0.0013000000000000234, 1: 0.017500000000000016}
Processing client 0
Processing client 1
