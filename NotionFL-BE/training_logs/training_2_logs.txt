FigureCanvasAgg is non-interactive, and thus cannot be shown
FigureCanvasAgg is non-interactive, and thus cannot be shown

FL Training Round 1/1

Training client 0 model...
Epoch 1/1, Loss: 0.7039

Evaluating client 0 model...
Test set: Loss: 0.2868, Accuracy: 0.9138, Precision: 0.9174, Recall: 0.9138, F1: 0.9137
Confusion Matrix:
[[ 952    0    0    0    0    7   13    1    7    0]
 [   0 1096    3    2    1    2    4    1   26    0]
 [   9    2  899    8   10    1   30   11   60    2]
 [   6    1   28  803    0   87    4   16   58    7]
 [   0    1    6    0  908    2   27    2    9   27]
 [   6    2    0    8    6  813   26    3   25    3]
 [   7    3    2    1    4   12  924    1    4    0]
 [   2    8   22    1    8    1    0  948   15   23]
 [   4    1    2    3    6   13    8    9  924    4]
 [  11    5    5    6   58   11    1   22   19  871]]

Training client 1 model...
Epoch 1/1, Loss: 0.3511

Evaluating client 1 model...
Test set: Loss: 0.2187, Accuracy: 0.9362, Precision: 0.9379, Recall: 0.9362, F1: 0.9362
Confusion Matrix:
[[ 971    0    1    2    0    2    2    1    1    0]
 [   0 1110    1    6    1    0    4    2   11    0]
 [  12    1  908   34   16    0    9   21   29    2]
 [   0    0    1  975    0    8    0    9    8    9]
 [   1    0    4    0  943    0    7    2    3   22]
 [  10    1    0   35    4  813    9    5   11    4]
 [  15    4    1    4    7   16  906    2    3    0]
 [   1    6   12   12    5    0    0  975    1   16]
 [   5    5    1   60    9   15    6   13  851    9]
 [  10    6    0   19   37    3    1   21    2  910]]
Aggregation explanation for round 0 saved successfully.
Global Model Test set: Average loss: 0.2187, Accuracy: 0.9362
Precision: 0.9379, Recall: 0.9362, F1 Score: 0.9362
Confusion Matrix:
[[ 971    0    1    2    0    2    2    1    1    0]
 [   0 1110    1    6    1    0    4    2   11    0]
 [  12    1  908   34   16    0    9   21   29    2]
 [   0    0    1  975    0    8    0    9    8    9]
 [   1    0    4    0  943    0    7    2    3   22]
 [  10    1    0   35    4  813    9    5   11    4]
 [  15    4    1    4    7   16  906    2    3    0]
 [   1    6   12   12    5    0    0  975    1   16]
 [   5    5    1   60    9   15    6   13  851    9]
 [  10    6    0   19   37    3    1   21    2  910]]
Global Model Test set: Average loss: 0.2187, Accuracy: 0.9362
Precision: 0.9379, Recall: 0.9362, F1 Score: 0.9362
Confusion Matrix:
[[ 971    0    1    2    0    2    2    1    1    0]
 [   0 1110    1    6    1    0    4    2   11    0]
 [  12    1  908   34   16    0    9   21   29    2]
 [   0    0    1  975    0    8    0    9    8    9]
 [   1    0    4    0  943    0    7    2    3   22]
 [  10    1    0   35    4  813    9    5   11    4]
 [  15    4    1    4    7   16  906    2    3    0]
 [   1    6   12   12    5    0    0  975    1   16]
 [   5    5    1   60    9   15    6   13  851    9]
 [  10    6    0   19   37    3    1   21    2  910]]
Global Model Test set: Average loss: 0.2187, Accuracy: 0.9362
Precision: 0.9379, Recall: 0.9362, F1 Score: 0.9362
Confusion Matrix:
[[ 971    0    1    2    0    2    2    1    1    0]
 [   0 1110    1    6    1    0    4    2   11    0]
 [  12    1  908   34   16    0    9   21   29    2]
 [   0    0    1  975    0    8    0    9    8    9]
 [   1    0    4    0  943    0    7    2    3   22]
 [  10    1    0   35    4  813    9    5   11    4]
 [  15    4    1    4    7   16  906    2    3    0]
 [   1    6   12   12    5    0    0  975    1   16]
 [   5    5    1   60    9   15    6   13  851    9]
 [  10    6    0   19   37    3    1   21    2  910]]
Global Model Test set: Average loss: 0.2868, Accuracy: 0.9138
Precision: 0.9174, Recall: 0.9138, F1 Score: 0.9137
Confusion Matrix:
[[ 952    0    0    0    0    7   13    1    7    0]
 [   0 1096    3    2    1    2    4    1   26    0]
 [   9    2  899    8   10    1   30   11   60    2]
 [   6    1   28  803    0   87    4   16   58    7]
 [   0    1    6    0  908    2   27    2    9   27]
 [   6    2    0    8    6  813   26    3   25    3]
 [   7    3    2    1    4   12  924    1    4    0]
 [   2    8   22    1    8    1    0  948   15   23]
 [   4    1    2    3    6   13    8    9  924    4]
 [  11    5    5    6   58   11    1   22   19  871]]
Global Model Test set: Average loss: 0.2222, Accuracy: 0.9356
Precision: 0.9359, Recall: 0.9356, F1 Score: 0.9355
Confusion Matrix:
[[ 960    0    0    2    0    4    8    1    5    0]
 [   0 1108    3    2    1    1    4    1   15    0]
 [  11    2  922   15   14    0   16   15   36    1]
 [   3    1   11  928    0   25    3   12   19    8]
 [   0    1    5    0  930    0   16    4    3   23]
 [   7    1    0   21    7  820   15    3   14    4]
 [   9    3    1    3    6   16  917    1    2    0]
 [   2    7   18    3    6    0    0  968    5   19]
 [   5    3    2   14    7   12    7   11  907    6]
 [  12    6    2   16   40    4    1   25    7  896]]
Global Model Test set: Average loss: 0.2222, Accuracy: 0.9356
Precision: 0.9359, Recall: 0.9356, F1 Score: 0.9355
Confusion Matrix:
[[ 960    0    0    2    0    4    8    1    5    0]
 [   0 1108    3    2    1    1    4    1   15    0]
 [  11    2  922   15   14    0   16   15   36    1]
 [   3    1   11  928    0   25    3   12   19    8]
 [   0    1    5    0  930    0   16    4    3   23]
 [   7    1    0   21    7  820   15    3   14    4]
 [   9    3    1    3    6   16  917    1    2    0]
 [   2    7   18    3    6    0    0  968    5   19]
 [   5    3    2   14    7   12    7   11  907    6]
 [  12    6    2   16   40    4    1   25    7  896]]
Global Model Test set: Average loss: 0.2187, Accuracy: 0.9362
Precision: 0.9379, Recall: 0.9362, F1 Score: 0.9362
Confusion Matrix:
[[ 971    0    1    2    0    2    2    1    1    0]
 [   0 1110    1    6    1    0    4    2   11    0]
 [  12    1  908   34   16    0    9   21   29    2]
 [   0    0    1  975    0    8    0    9    8    9]
 [   1    0    4    0  943    0    7    2    3   22]
 [  10    1    0   35    4  813    9    5   11    4]
 [  15    4    1    4    7   16  906    2    3    0]
 [   1    6   12   12    5    0    0  975    1   16]
 [   5    5    1   60    9   15    6   13  851    9]
 [  10    6    0   19   37    3    1   21    2  910]]
Global Model Test set: Average loss: 0.2187, Accuracy: 0.9362
Precision: 0.9379, Recall: 0.9362, F1 Score: 0.9362
Confusion Matrix:
[[ 971    0    1    2    0    2    2    1    1    0]
 [   0 1110    1    6    1    0    4    2   11    0]
 [  12    1  908   34   16    0    9   21   29    2]
 [   0    0    1  975    0    8    0    9    8    9]
 [   1    0    4    0  943    0    7    2    3   22]
 [  10    1    0   35    4  813    9    5   11    4]
 [  15    4    1    4    7   16  906    2    3    0]
 [   1    6   12   12    5    0    0  975    1   16]
 [   5    5    1   60    9   15    6   13  851    9]
 [  10    6    0   19   37    3    1   21    2  910]]
Global Model Test set: Average loss: 0.2222, Accuracy: 0.9356
Precision: 0.9359, Recall: 0.9356, F1 Score: 0.9355
Confusion Matrix:
[[ 960    0    0    2    0    4    8    1    5    0]
 [   0 1108    3    2    1    1    4    1   15    0]
 [  11    2  922   15   14    0   16   15   36    1]
 [   3    1   11  928    0   25    3   12   19    8]
 [   0    1    5    0  930    0   16    4    3   23]
 [   7    1    0   21    7  820   15    3   14    4]
 [   9    3    1    3    6   16  917    1    2    0]
 [   2    7   18    3    6    0    0  968    5   19]
 [   5    3    2   14    7   12    7   11  907    6]
 [  12    6    2   16   40    4    1   25    7  896]]
Global Model Test set: Average loss: 0.2222, Accuracy: 0.9356
Precision: 0.9359, Recall: 0.9356, F1 Score: 0.9355
Confusion Matrix:
[[ 960    0    0    2    0    4    8    1    5    0]
 [   0 1108    3    2    1    1    4    1   15    0]
 [  11    2  922   15   14    0   16   15   36    1]
 [   3    1   11  928    0   25    3   12   19    8]
 [   0    1    5    0  930    0   16    4    3   23]
 [   7    1    0   21    7  820   15    3   14    4]
 [   9    3    1    3    6   16  917    1    2    0]
 [   2    7   18    3    6    0    0  968    5   19]
 [   5    3    2   14    7   12    7   11  907    6]
 [  12    6    2   16   40    4    1   25    7  896]]
Global Model Test set: Average loss: 0.2868, Accuracy: 0.9138
Precision: 0.9174, Recall: 0.9138, F1 Score: 0.9137
Confusion Matrix:
[[ 952    0    0    0    0    7   13    1    7    0]
 [   0 1096    3    2    1    2    4    1   26    0]
 [   9    2  899    8   10    1   30   11   60    2]
 [   6    1   28  803    0   87    4   16   58    7]
 [   0    1    6    0  908    2   27    2    9   27]
 [   6    2    0    8    6  813   26    3   25    3]
 [   7    3    2    1    4   12  924    1    4    0]
 [   2    8   22    1    8    1    0  948   15   23]
 [   4    1    2    3    6   13    8    9  924    4]
 [  11    5    5    6   58   11    1   22   19  871]]
Shapley Values for round 1: {0: -0.011200000000000043, 1: 0.011200000000000043}
Traceback (most recent call last):
  File "D:\Rathe\Final Year\FYP\Implementation\NotionFL\notionfl-be\main.py", line 209, in <module>
    main()
  File "D:\Rathe\Final Year\FYP\Implementation\NotionFL\notionfl-be\main.py", line 184, in main
    allocate_and_save_incentives(round+1)
  File "D:\Rathe\Final Year\FYP\Implementation\NotionFL\notionfl-be\utils\allocate_incentive.py", line 41, in allocate_and_save_incentives
    incentives = calculate_incentives(shapley_values, total_incentive_pool)
  File "D:\Rathe\Final Year\FYP\Implementation\NotionFL\notionfl-be\utils\allocate_incentive.py", line 12, in calculate_incentives
    return {client_id: (value / total_shapley) * total_incentive_pool 
  File "D:\Rathe\Final Year\FYP\Implementation\NotionFL\notionfl-be\utils\allocate_incentive.py", line 12, in <dictcomp>
    return {client_id: (value / total_shapley) * total_incentive_pool 
ZeroDivisionError: float division by zero
