FigureCanvasAgg is non-interactive, and thus cannot be shown
FigureCanvasAgg is non-interactive, and thus cannot be shown
FigureCanvasAgg is non-interactive, and thus cannot be shown
FigureCanvasAgg is non-interactive, and thus cannot be shown

FL Training Round 1/2

Training client 0 model...
Epoch 1/10, Loss: 0.9339
Epoch 2/10, Loss: 0.4391
Epoch 3/10, Loss: 0.3626
Epoch 4/10, Loss: 0.3206
Epoch 5/10, Loss: 0.2946
Epoch 6/10, Loss: 0.2764
Epoch 7/10, Loss: 0.2435
Epoch 8/10, Loss: 0.2379
Epoch 9/10, Loss: 0.2217
Epoch 10/10, Loss: 0.2038

Evaluating client 0 model...
Test set: Loss: 0.1456, Accuracy: 0.9526, Precision: 0.9540, Recall: 0.9526, F1: 0.9526
Confusion Matrix:
[[ 968    0    1    2    0    1    4    0    3    1]
 [   0 1123    3    3    0    0    3    0    3    0]
 [   6    0  995    7    4    0    3    4   12    1]
 [   1    0   12  966    0    9    0    6   12    4]
 [   0    0    3    0  918    0    7    0    3   51]
 [   7    1    0   19    3  846    7    0    3    6]
 [  12    3    1    1    5    6  926    0    4    0]
 [   0    7   27    2    7    0    0  898    2   85]
 [   7    4    3   12    4    7    5    4  922    6]
 [   7    7    0   10    7    7    0    2    5  964]]

Training client 1 model...
Epoch 1/10, Loss: 0.2302
Epoch 2/10, Loss: 0.2091
Epoch 3/10, Loss: 0.1977
Epoch 4/10, Loss: 0.1816
Epoch 5/10, Loss: 0.1703
Epoch 6/10, Loss: 0.1547
Epoch 7/10, Loss: 0.1449
Epoch 8/10, Loss: 0.1350
Epoch 9/10, Loss: 0.1284
Epoch 10/10, Loss: 0.1182

Evaluating client 1 model...
Test set: Loss: 0.0763, Accuracy: 0.9762, Precision: 0.9762, Recall: 0.9762, F1: 0.9762
Confusion Matrix:
[[ 973    0    1    0    0    0    1    1    4    0]
 [   0 1125    2    2    0    0    2    0    4    0]
 [   7    1 1006    2    2    0    1    7    6    0]
 [   1    0    4  991    0    2    0    7    4    1]
 [   1    0    3    0  952    0    6    1    2   17]
 [   3    1    0    6    1  872    3    2    3    1]
 [   9    3    0    1    4    5  933    0    3    0]
 [   1    6   13    3    0    0    0  998    2    5]
 [   6    1    3    3    2    6    3    3  945    2]
 [   5    6    0    9    7    2    0    7    6  967]]

Training client 2 model...
Epoch 1/10, Loss: 0.1426
Epoch 2/10, Loss: 0.1236
Epoch 3/10, Loss: 0.1140
Epoch 4/10, Loss: 0.1067
Epoch 5/10, Loss: 0.1039
Epoch 6/10, Loss: 0.0937
Epoch 7/10, Loss: 0.0900
Epoch 8/10, Loss: 0.0868
Epoch 9/10, Loss: 0.0828
Epoch 10/10, Loss: 0.0800

Evaluating client 2 model...
Test set: Loss: 0.0505, Accuracy: 0.9831, Precision: 0.9831, Recall: 0.9831, F1: 0.9831
Confusion Matrix:
[[ 971    0    1    0    0    0    3    1    3    1]
 [   0 1128    2    1    0    1    1    0    2    0]
 [   2    4 1016    1    1    1    0    5    2    0]
 [   0    0    2  998    0    4    0    4    2    0]
 [   0    0    3    0  965    0    4    2    1    7]
 [   3    1    0    5    1  872    5    1    3    1]
 [   5    3    1    1    2    3  941    0    2    0]
 [   1    2   10    1    0    0    0 1011    1    2]
 [   4    0    2    3    2    0    0    4  954    5]
 [   4    5    0    6    7    0    0    9    3  975]]

Training client 3 model...
Epoch 1/10, Loss: 0.1092
Epoch 2/10, Loss: 0.0947
Epoch 3/10, Loss: 0.0913
Epoch 4/10, Loss: 0.0878
Epoch 5/10, Loss: 0.0799
Epoch 6/10, Loss: 0.0780
Epoch 7/10, Loss: 0.0724
Epoch 8/10, Loss: 0.0669
Epoch 9/10, Loss: 0.0656
Epoch 10/10, Loss: 0.0631

Evaluating client 3 model...
Test set: Loss: 0.0428, Accuracy: 0.9859, Precision: 0.9859, Recall: 0.9859, F1: 0.9859
Confusion Matrix:
[[ 972    0    0    0    0    0    3    1    3    1]
 [   0 1127    2    1    0    0    2    0    3    0]
 [   3    0 1021    0    2    0    0    5    1    0]
 [   0    0    2 1000    0    3    0    3    2    0]
 [   0    0    1    0  967    0    4    0    2    8]
 [   3    0    0    4    0  876    4    1    3    1]
 [   5    2    0    0    1    1  945    0    4    0]
 [   1    1    8    1    0    0    0 1015    1    1]
 [   7    1    3    4    0    0    1    3  951    4]
 [   5    3    0    4    3    2    0    5    2  985]]
Aggregation explanation for round 0 saved successfully.
Global Model Test set: Average loss: 0.0428, Accuracy: 0.9859
Precision: 0.9859, Recall: 0.9859, F1 Score: 0.9859
Confusion Matrix:
[[ 972    0    0    0    0    0    3    1    3    1]
 [   0 1127    2    1    0    0    2    0    3    0]
 [   3    0 1021    0    2    0    0    5    1    0]
 [   0    0    2 1000    0    3    0    3    2    0]
 [   0    0    1    0  967    0    4    0    2    8]
 [   3    0    0    4    0  876    4    1    3    1]
 [   5    2    0    0    1    1  945    0    4    0]
 [   1    1    8    1    0    0    0 1015    1    1]
 [   7    1    3    4    0    0    1    3  951    4]
 [   5    3    0    4    3    2    0    5    2  985]]
Global Model Test set: Average loss: 0.0428, Accuracy: 0.9859
Precision: 0.9859, Recall: 0.9859, F1 Score: 0.9859
Confusion Matrix:
[[ 972    0    0    0    0    0    3    1    3    1]
 [   0 1127    2    1    0    0    2    0    3    0]
 [   3    0 1021    0    2    0    0    5    1    0]
 [   0    0    2 1000    0    3    0    3    2    0]
 [   0    0    1    0  967    0    4    0    2    8]
 [   3    0    0    4    0  876    4    1    3    1]
 [   5    2    0    0    1    1  945    0    4    0]
 [   1    1    8    1    0    0    0 1015    1    1]
 [   7    1    3    4    0    0    1    3  951    4]
 [   5    3    0    4    3    2    0    5    2  985]]
Global Model Test set: Average loss: 0.0428, Accuracy: 0.9859
Precision: 0.9859, Recall: 0.9859, F1 Score: 0.9859
Confusion Matrix:
[[ 972    0    0    0    0    0    3    1    3    1]
 [   0 1127    2    1    0    0    2    0    3    0]
 [   3    0 1021    0    2    0    0    5    1    0]
 [   0    0    2 1000    0    3    0    3    2    0]
 [   0    0    1    0  967    0    4    0    2    8]
 [   3    0    0    4    0  876    4    1    3    1]
 [   5    2    0    0    1    1  945    0    4    0]
 [   1    1    8    1    0    0    0 1015    1    1]
 [   7    1    3    4    0    0    1    3  951    4]
 [   5    3    0    4    3    2    0    5    2  985]]
Global Model Test set: Average loss: 0.1456, Accuracy: 0.9526
Precision: 0.9540, Recall: 0.9526, F1 Score: 0.9526
Confusion Matrix:
[[ 968    0    1    2    0    1    4    0    3    1]
 [   0 1123    3    3    0    0    3    0    3    0]
 [   6    0  995    7    4    0    3    4   12    1]
 [   1    0   12  966    0    9    0    6   12    4]
 [   0    0    3    0  918    0    7    0    3   51]
 [   7    1    0   19    3  846    7    0    3    6]
 [  12    3    1    1    5    6  926    0    4    0]
 [   0    7   27    2    7    0    0  898    2   85]
 [   7    4    3   12    4    7    5    4  922    6]
 [   7    7    0   10    7    7    0    2    5  964]]
Global Model Test set: Average loss: 0.1313, Accuracy: 0.9602
Precision: 0.9603, Recall: 0.9602, F1 Score: 0.9602
Confusion Matrix:
[[ 970    0    1    0    0    3    3    1    2    0]
 [   0 1126    3    1    0    0    3    0    2    0]
 [  10    4  985    2    6    1    2   10   12    0]
 [   0    0   16  955    0    8    0   10   13    8]
 [   1    1    4    0  941    0    6    1    2   26]
 [   6    2    1   12    2  839   11    1   11    7]
 [  12    3    0    1    4    5  928    0    5    0]
 [   1   10   16    1    3    0    0  977    1   19]
 [   7    4    4    6    6    8    6    8  917    8]
 [   4    7    0    8   15    2    1    5    3  964]]
Global Model Test set: Average loss: 0.0987, Accuracy: 0.9678
Precision: 0.9680, Recall: 0.9678, F1 Score: 0.9678
Confusion Matrix:
[[ 970    0    1    1    0    1    3    1    3    0]
 [   0 1126    2    2    0    0    2    0    3    0]
 [   7    1 1001    4    3    0    2    4    9    1]
 [   1    0    4  982    0    4    0    7    9    3]
 [   1    0    3    0  941    0    7    1    3   26]
 [   5    1    0   15    1  854    7    1    4    4]
 [  12    3    1    1    4    5  929    0    3    0]
 [   2    6   20    2    2    0    0  963    2   31]
 [   5    1    3    8    2    5    3    3  942    2]
 [   6    7    0   10    5    2    0    4    5  970]]
Global Model Test set: Average loss: 0.0763, Accuracy: 0.9762
Precision: 0.9762, Recall: 0.9762, F1 Score: 0.9762
Confusion Matrix:
[[ 973    0    1    0    0    0    1    1    4    0]
 [   0 1125    2    2    0    0    2    0    4    0]
 [   7    1 1006    2    2    0    1    7    6    0]
 [   1    0    4  991    0    2    0    7    4    1]
 [   1    0    3    0  952    0    6    1    2   17]
 [   3    1    0    6    1  872    3    2    3    1]
 [   9    3    0    1    4    5  933    0    3    0]
 [   1    6   13    3    0    0    0  998    2    5]
 [   6    1    3    3    2    6    3    3  945    2]
 [   5    6    0    9    7    2    0    7    6  967]]
Global Model Test set: Average loss: 0.0840, Accuracy: 0.9728
Precision: 0.9730, Recall: 0.9728, F1 Score: 0.9728
Confusion Matrix:
[[ 972    0    1    0    0    0    2    1    4    0]
 [   0 1125    2    2    0    0    1    0    5    0]
 [   6    2 1004    2    3    0    1    5    9    0]
 [   0    0    4  985    0    3    0    8    8    2]
 [   1    0    3    0  955    0    4    0    2   17]
 [   5    1    0   10    1  858    5    1    5    6]
 [   8    3    1    1    3    2  936    0    4    0]
 [   1    6   16    0    3    0    0  974    1   27]
 [   4    1    1    6    3    1    2    5  948    3]
 [   5    7    1    8    6    0    0    3    8  971]]
Global Model Test set: Average loss: 0.0505, Accuracy: 0.9831
Precision: 0.9831, Recall: 0.9831, F1 Score: 0.9831
Confusion Matrix:
[[ 971    0    1    0    0    0    3    1    3    1]
 [   0 1128    2    1    0    1    1    0    2    0]
 [   2    4 1016    1    1    1    0    5    2    0]
 [   0    0    2  998    0    4    0    4    2    0]
 [   0    0    3    0  965    0    4    2    1    7]
 [   3    1    0    5    1  872    5    1    3    1]
 [   5    3    1    1    2    3  941    0    2    0]
 [   1    2   10    1    0    0    0 1011    1    2]
 [   4    0    2    3    2    0    0    4  954    5]
 [   4    5    0    6    7    0    0    9    3  975]]
Global Model Test set: Average loss: 0.0801, Accuracy: 0.9729
Precision: 0.9732, Recall: 0.9729, F1 Score: 0.9729
Confusion Matrix:
[[ 972    0    0    0    0    0    3    1    4    0]
 [   0 1123    2    1    0    0    3    0    6    0]
 [   7    0 1004    1    3    0    2    5   10    0]
 [   0    0    4  987    0    2    0    5    8    4]
 [   0    0    1    0  958    0    6    0    2   15]
 [   5    0    0   14    2  851    7    1    6    6]
 [   8    3    0    1    2    1  938    0    5    0]
 [   2    6   17    1    2    0    0  970    1   29]
 [   6    1    1    5    3    0    2    3  951    2]
 [   5    5    0    6    6    0    0    4    8  975]]
Global Model Test set: Average loss: 0.0428, Accuracy: 0.9859
Precision: 0.9859, Recall: 0.9859, F1 Score: 0.9859
Confusion Matrix:
[[ 972    0    0    0    0    0    3    1    3    1]
 [   0 1127    2    1    0    0    2    0    3    0]
 [   3    0 1021    0    2    0    0    5    1    0]
 [   0    0    2 1000    0    3    0    3    2    0]
 [   0    0    1    0  967    0    4    0    2    8]
 [   3    0    0    4    0  876    4    1    3    1]
 [   5    2    0    0    1    1  945    0    4    0]
 [   1    1    8    1    0    0    0 1015    1    1]
 [   7    1    3    4    0    0    1    3  951    4]
 [   5    3    0    4    3    2    0    5    2  985]]
Global Model Test set: Average loss: 0.0772, Accuracy: 0.9750
Precision: 0.9751, Recall: 0.9750, F1 Score: 0.9750
Confusion Matrix:
[[ 971    0    1    0    0    0    3    1    4    0]
 [   0 1126    2    2    0    0    1    0    4    0]
 [   6    2 1005    1    3    0    1    6    8    0]
 [   0    0    4  987    0    3    0    8    7    1]
 [   1    0    3    0  954    0    5    1    2   16]
 [   3    1    0    8    1  866    5    1    3    4]
 [   7    3    0    1    3    2  938    0    4    0]
 [   1    6   15    1    1    0    0  984    1   19]
 [   5    1    2    5    2    1    2    4  949    3]
 [   5    7    0   10    6    0    0    4    7  970]]
Global Model Test set: Average loss: 0.0590, Accuracy: 0.9810
Precision: 0.9810, Recall: 0.9810, F1 Score: 0.9810
Confusion Matrix:
[[ 973    0    1    0    0    0    1    1    4    0]
 [   0 1126    2    2    0    0    1    0    4    0]
 [   3    4 1013    1    1    1    0    7    2    0]
 [   0    0    2  993    0    4    0    6    4    1]
 [   1    0    3    0  961    0    4    1    2   10]
 [   3    1    0    5    1  873    4    1    3    1]
 [   7    3    0    1    2    2  940    0    3    0]
 [   1    3   11    1    0    0    0 1006    2    4]
 [   6    1    3    2    1    0    1    3  953    4]
 [   4    5    0    9    8    0    0    6    5  972]]
Global Model Test set: Average loss: 0.0739, Accuracy: 0.9759
Precision: 0.9760, Recall: 0.9759, F1 Score: 0.9759
Confusion Matrix:
[[ 971    0    1    0    0    0    3    1    4    0]
 [   0 1125    2    1    0    0    2    0    5    0]
 [   7    0 1006    1    3    0    1    6    8    0]
 [   0    0    4  991    0    3    0    6    5    1]
 [   1    0    2    0  956    0    6    0    2   15]
 [   3    1    0    8    1  865    5    1    5    3]
 [   7    3    0    1    2    2  939    0    4    0]
 [   2    6   17    1    0    0    0  982    1   19]
 [   6    1    1    5    2    1    2    3  951    2]
 [   5    5    0    8    6    1    0    4    7  973]]
Global Model Test set: Average loss: 0.0539, Accuracy: 0.9820
Precision: 0.9820, Recall: 0.9820, F1 Score: 0.9820
Confusion Matrix:
[[ 970    0    1    0    0    0    3    1    4    1]
 [   0 1126    2    1    0    0    2    0    4    0]
 [   4    0 1014    1    3    0    0    7    3    0]
 [   0    0    2  995    0    3    0    6    4    0]
 [   0    0    2    0  963    0    5    0    2   10]
 [   3    0    0    6    0  872    4    1    3    3]
 [   7    3    0    1    2    2  940    0    3    0]
 [   1    3   11    1    0    0    0 1008    1    3]
 [   6    1    3    2    1    0    1    3  955    2]
 [   6    4    0    6    6    1    0    5    4  977]]
Global Model Test set: Average loss: 0.0645, Accuracy: 0.9791
Precision: 0.9792, Recall: 0.9791, F1 Score: 0.9791
Confusion Matrix:
[[ 972    0    1    0    0    0    2    1    4    0]
 [   0 1126    2    1    0    0    1    0    5    0]
 [   6    0 1008    1    3    0    1    5    8    0]
 [   0    0    2  992    0    3    0    6    6    1]
 [   0    0    2    0  961    0    4    0    2   13]
 [   3    1    0    9    1  864    5    1    5    3]
 [   7    3    0    1    1    2  940    0    4    0]
 [   1    4   13    1    1    0    0  995    1   12]
 [   5    1    1    4    3    0    2    3  953    2]
 [   5    5    0    6    6    0    0    4    3  980]]
Global Model Test set: Average loss: 0.0440, Accuracy: 0.9852
Precision: 0.9852, Recall: 0.9852, F1 Score: 0.9852
Confusion Matrix:
[[ 971    0    1    0    0    0    3    1    3    1]
 [   0 1126    2    1    0    1    2    0    3    0]
 [   3    3 1017    1    2    0    0    4    2    0]
 [   0    0    2 1000    0    3    0    3    2    0]
 [   0    0    1    0  969    0    4    0    2    6]
 [   3    0    0    3    0  877    4    1    3    1]
 [   6    2    0    0    1    2  945    0    2    0]
 [   1    1   10    1    0    0    0 1013    1    1]
 [   5    1    3    3    1    0    1    3  953    4]
 [   5    4    0    4    6    0    0    6    3  981]]
Global Model Test set: Average loss: 0.0650, Accuracy: 0.9802
Precision: 0.9803, Recall: 0.9802, F1 Score: 0.9802
Confusion Matrix:
[[ 972    0    1    0    0    0    2    1    4    0]
 [   0 1127    2    1    0    0    1    0    4    0]
 [   6    0 1009    1    3    0    1    6    6    0]
 [   0    0    2  993    0    3    0    6    5    1]
 [   1    0    2    0  960    0    4    1    2   12]
 [   3    1    0    6    1  870    5    1    3    2]
 [   7    3    0    1    2    2  939    0    4    0]
 [   1    5   13    1    0    0    0  999    1    8]
 [   6    1    1    3    2    0    2    3  954    2]
 [   5    5    0    6    6    1    0    4    3  979]]
Global Model Test set: Average loss: 0.0511, Accuracy: 0.9826
Precision: 0.9826, Recall: 0.9826, F1 Score: 0.9826
Confusion Matrix:
[[ 971    0    1    0    0    0    2    1    4    1]
 [   0 1126    2    1    0    0    2    0    4    0]
 [   3    2 1015    2    2    0    0    6    2    0]
 [   0    0    2  998    0    3    0    4    3    0]
 [   0    0    2    0  965    0    4    1    2    8]
 [   3    0    0    5    0  874    4    1    3    2]
 [   6    3    0    1    2    2  940    0    4    0]
 [   1    3   10    1    0    0    0 1009    1    3]
 [   6    1    3    3    1    0    1    3  952    4]
 [   5    5    0    6    7    0    0    6    4  976]]
Global Model Test set: Average loss: 0.0763, Accuracy: 0.9762
Precision: 0.9762, Recall: 0.9762, F1 Score: 0.9762
Confusion Matrix:
[[ 973    0    1    0    0    0    1    1    4    0]
 [   0 1125    2    2    0    0    2    0    4    0]
 [   7    1 1006    2    2    0    1    7    6    0]
 [   1    0    4  991    0    2    0    7    4    1]
 [   1    0    3    0  952    0    6    1    2   17]
 [   3    1    0    6    1  872    3    2    3    1]
 [   9    3    0    1    4    5  933    0    3    0]
 [   1    6   13    3    0    0    0  998    2    5]
 [   6    1    3    3    2    6    3    3  945    2]
 [   5    6    0    9    7    2    0    7    6  967]]
Global Model Test set: Average loss: 0.1313, Accuracy: 0.9602
Precision: 0.9603, Recall: 0.9602, F1 Score: 0.9602
Confusion Matrix:
[[ 970    0    1    0    0    3    3    1    2    0]
 [   0 1126    3    1    0    0    3    0    2    0]
 [  10    4  985    2    6    1    2   10   12    0]
 [   0    0   16  955    0    8    0   10   13    8]
 [   1    1    4    0  941    0    6    1    2   26]
 [   6    2    1   12    2  839   11    1   11    7]
 [  12    3    0    1    4    5  928    0    5    0]
 [   1   10   16    1    3    0    0  977    1   19]
 [   7    4    4    6    6    8    6    8  917    8]
 [   4    7    0    8   15    2    1    5    3  964]]
Global Model Test set: Average loss: 0.0987, Accuracy: 0.9678
Precision: 0.9680, Recall: 0.9678, F1 Score: 0.9678
Confusion Matrix:
[[ 970    0    1    1    0    1    3    1    3    0]
 [   0 1126    2    2    0    0    2    0    3    0]
 [   7    1 1001    4    3    0    2    4    9    1]
 [   1    0    4  982    0    4    0    7    9    3]
 [   1    0    3    0  941    0    7    1    3   26]
 [   5    1    0   15    1  854    7    1    4    4]
 [  12    3    1    1    4    5  929    0    3    0]
 [   2    6   20    2    2    0    0  963    2   31]
 [   5    1    3    8    2    5    3    3  942    2]
 [   6    7    0   10    5    2    0    4    5  970]]
Global Model Test set: Average loss: 0.1456, Accuracy: 0.9526
Precision: 0.9540, Recall: 0.9526, F1 Score: 0.9526
Confusion Matrix:
[[ 968    0    1    2    0    1    4    0    3    1]
 [   0 1123    3    3    0    0    3    0    3    0]
 [   6    0  995    7    4    0    3    4   12    1]
 [   1    0   12  966    0    9    0    6   12    4]
 [   0    0    3    0  918    0    7    0    3   51]
 [   7    1    0   19    3  846    7    0    3    6]
 [  12    3    1    1    5    6  926    0    4    0]
 [   0    7   27    2    7    0    0  898    2   85]
 [   7    4    3   12    4    7    5    4  922    6]
 [   7    7    0   10    7    7    0    2    5  964]]
Global Model Test set: Average loss: 0.0590, Accuracy: 0.9810
Precision: 0.9810, Recall: 0.9810, F1 Score: 0.9810
Confusion Matrix:
[[ 973    0    1    0    0    0    1    1    4    0]
 [   0 1126    2    2    0    0    1    0    4    0]
 [   3    4 1013    1    1    1    0    7    2    0]
 [   0    0    2  993    0    4    0    6    4    1]
 [   1    0    3    0  961    0    4    1    2   10]
 [   3    1    0    5    1  873    4    1    3    1]
 [   7    3    0    1    2    2  940    0    3    0]
 [   1    3   11    1    0    0    0 1006    2    4]
 [   6    1    3    2    1    0    1    3  953    4]
 [   4    5    0    9    8    0    0    6    5  972]]
Global Model Test set: Average loss: 0.0505, Accuracy: 0.9831
Precision: 0.9831, Recall: 0.9831, F1 Score: 0.9831
Confusion Matrix:
[[ 971    0    1    0    0    0    3    1    3    1]
 [   0 1128    2    1    0    1    1    0    2    0]
 [   2    4 1016    1    1    1    0    5    2    0]
 [   0    0    2  998    0    4    0    4    2    0]
 [   0    0    3    0  965    0    4    2    1    7]
 [   3    1    0    5    1  872    5    1    3    1]
 [   5    3    1    1    2    3  941    0    2    0]
 [   1    2   10    1    0    0    0 1011    1    2]
 [   4    0    2    3    2    0    0    4  954    5]
 [   4    5    0    6    7    0    0    9    3  975]]
Global Model Test set: Average loss: 0.0539, Accuracy: 0.9820
Precision: 0.9820, Recall: 0.9820, F1 Score: 0.9820
Confusion Matrix:
[[ 970    0    1    0    0    0    3    1    4    1]
 [   0 1126    2    1    0    0    2    0    4    0]
 [   4    0 1014    1    3    0    0    7    3    0]
 [   0    0    2  995    0    3    0    6    4    0]
 [   0    0    2    0  963    0    5    0    2   10]
 [   3    0    0    6    0  872    4    1    3    3]
 [   7    3    0    1    2    2  940    0    3    0]
 [   1    3   11    1    0    0    0 1008    1    3]
 [   6    1    3    2    1    0    1    3  955    2]
 [   6    4    0    6    6    1    0    5    4  977]]
Global Model Test set: Average loss: 0.0428, Accuracy: 0.9859
Precision: 0.9859, Recall: 0.9859, F1 Score: 0.9859
Confusion Matrix:
[[ 972    0    0    0    0    0    3    1    3    1]
 [   0 1127    2    1    0    0    2    0    3    0]
 [   3    0 1021    0    2    0    0    5    1    0]
 [   0    0    2 1000    0    3    0    3    2    0]
 [   0    0    1    0  967    0    4    0    2    8]
 [   3    0    0    4    0  876    4    1    3    1]
 [   5    2    0    0    1    1  945    0    4    0]
 [   1    1    8    1    0    0    0 1015    1    1]
 [   7    1    3    4    0    0    1    3  951    4]
 [   5    3    0    4    3    2    0    5    2  985]]
Global Model Test set: Average loss: 0.0772, Accuracy: 0.9750
Precision: 0.9751, Recall: 0.9750, F1 Score: 0.9750
Confusion Matrix:
[[ 971    0    1    0    0    0    3    1    4    0]
 [   0 1126    2    2    0    0    1    0    4    0]
 [   6    2 1005    1    3    0    1    6    8    0]
 [   0    0    4  987    0    3    0    8    7    1]
 [   1    0    3    0  954    0    5    1    2   16]
 [   3    1    0    8    1  866    5    1    3    4]
 [   7    3    0    1    3    2  938    0    4    0]
 [   1    6   15    1    1    0    0  984    1   19]
 [   5    1    2    5    2    1    2    4  949    3]
 [   5    7    0   10    6    0    0    4    7  970]]
Global Model Test set: Average loss: 0.0840, Accuracy: 0.9728
Precision: 0.9730, Recall: 0.9728, F1 Score: 0.9728
Confusion Matrix:
[[ 972    0    1    0    0    0    2    1    4    0]
 [   0 1125    2    2    0    0    1    0    5    0]
 [   6    2 1004    2    3    0    1    5    9    0]
 [   0    0    4  985    0    3    0    8    8    2]
 [   1    0    3    0  955    0    4    0    2   17]
 [   5    1    0   10    1  858    5    1    5    6]
 [   8    3    1    1    3    2  936    0    4    0]
 [   1    6   16    0    3    0    0  974    1   27]
 [   4    1    1    6    3    1    2    5  948    3]
 [   5    7    1    8    6    0    0    3    8  971]]
Global Model Test set: Average loss: 0.0739, Accuracy: 0.9759
Precision: 0.9760, Recall: 0.9759, F1 Score: 0.9759
Confusion Matrix:
[[ 971    0    1    0    0    0    3    1    4    0]
 [   0 1125    2    1    0    0    2    0    5    0]
 [   7    0 1006    1    3    0    1    6    8    0]
 [   0    0    4  991    0    3    0    6    5    1]
 [   1    0    2    0  956    0    6    0    2   15]
 [   3    1    0    8    1  865    5    1    5    3]
 [   7    3    0    1    2    2  939    0    4    0]
 [   2    6   17    1    0    0    0  982    1   19]
 [   6    1    1    5    2    1    2    3  951    2]
 [   5    5    0    8    6    1    0    4    7  973]]
Global Model Test set: Average loss: 0.0801, Accuracy: 0.9729
Precision: 0.9732, Recall: 0.9729, F1 Score: 0.9729
Confusion Matrix:
[[ 972    0    0    0    0    0    3    1    4    0]
 [   0 1123    2    1    0    0    3    0    6    0]
 [   7    0 1004    1    3    0    2    5   10    0]
 [   0    0    4  987    0    2    0    5    8    4]
 [   0    0    1    0  958    0    6    0    2   15]
 [   5    0    0   14    2  851    7    1    6    6]
 [   8    3    0    1    2    1  938    0    5    0]
 [   2    6   17    1    2    0    0  970    1   29]
 [   6    1    1    5    3    0    2    3  951    2]
 [   5    5    0    6    6    0    0    4    8  975]]
Global Model Test set: Average loss: 0.0511, Accuracy: 0.9826
Precision: 0.9826, Recall: 0.9826, F1 Score: 0.9826
Confusion Matrix:
[[ 971    0    1    0    0    0    2    1    4    1]
 [   0 1126    2    1    0    0    2    0    4    0]
 [   3    2 1015    2    2    0    0    6    2    0]
 [   0    0    2  998    0    3    0    4    3    0]
 [   0    0    2    0  965    0    4    1    2    8]
 [   3    0    0    5    0  874    4    1    3    2]
 [   6    3    0    1    2    2  940    0    4    0]
 [   1    3   10    1    0    0    0 1009    1    3]
 [   6    1    3    3    1    0    1    3  952    4]
 [   5    5    0    6    7    0    0    6    4  976]]
Global Model Test set: Average loss: 0.0440, Accuracy: 0.9852
Precision: 0.9852, Recall: 0.9852, F1 Score: 0.9852
Confusion Matrix:
[[ 971    0    1    0    0    0    3    1    3    1]
 [   0 1126    2    1    0    1    2    0    3    0]
 [   3    3 1017    1    2    0    0    4    2    0]
 [   0    0    2 1000    0    3    0    3    2    0]
 [   0    0    1    0  969    0    4    0    2    6]
 [   3    0    0    3    0  877    4    1    3    1]
 [   6    2    0    0    1    2  945    0    2    0]
 [   1    1   10    1    0    0    0 1013    1    1]
 [   5    1    3    3    1    0    1    3  953    4]
 [   5    4    0    4    6    0    0    6    3  981]]
Global Model Test set: Average loss: 0.0650, Accuracy: 0.9802
Precision: 0.9803, Recall: 0.9802, F1 Score: 0.9802
Confusion Matrix:
[[ 972    0    1    0    0    0    2    1    4    0]
 [   0 1127    2    1    0    0    1    0    4    0]
 [   6    0 1009    1    3    0    1    6    6    0]
 [   0    0    2  993    0    3    0    6    5    1]
 [   1    0    2    0  960    0    4    1    2   12]
 [   3    1    0    6    1  870    5    1    3    2]
 [   7    3    0    1    2    2  939    0    4    0]
 [   1    5   13    1    0    0    0  999    1    8]
 [   6    1    1    3    2    0    2    3  954    2]
 [   5    5    0    6    6    1    0    4    3  979]]
Global Model Test set: Average loss: 0.0645, Accuracy: 0.9791
Precision: 0.9792, Recall: 0.9791, F1 Score: 0.9791
Confusion Matrix:
[[ 972    0    1    0    0    0    2    1    4    0]
 [   0 1126    2    1    0    0    1    0    5    0]
 [   6    0 1008    1    3    0    1    5    8    0]
 [   0    0    2  992    0    3    0    6    6    1]
 [   0    0    2    0  961    0    4    0    2   13]
 [   3    1    0    9    1  864    5    1    5    3]
 [   7    3    0    1    1    2  940    0    4    0]
 [   1    4   13    1    1    0    0  995    1   12]
 [   5    1    1    4    3    0    2    3  953    2]
 [   5    5    0    6    6    0    0    4    3  980]]
Global Model Test set: Average loss: 0.0505, Accuracy: 0.9831
Precision: 0.9831, Recall: 0.9831, F1 Score: 0.9831
Confusion Matrix:
[[ 971    0    1    0    0    0    3    1    3    1]
 [   0 1128    2    1    0    1    1    0    2    0]
 [   2    4 1016    1    1    1    0    5    2    0]
 [   0    0    2  998    0    4    0    4    2    0]
 [   0    0    3    0  965    0    4    2    1    7]
 [   3    1    0    5    1  872    5    1    3    1]
 [   5    3    1    1    2    3  941    0    2    0]
 [   1    2   10    1    0    0    0 1011    1    2]
 [   4    0    2    3    2    0    0    4  954    5]
 [   4    5    0    6    7    0    0    9    3  975]]
Global Model Test set: Average loss: 0.1313, Accuracy: 0.9602
Precision: 0.9603, Recall: 0.9602, F1 Score: 0.9602
Confusion Matrix:
[[ 970    0    1    0    0    3    3    1    2    0]
 [   0 1126    3    1    0    0    3    0    2    0]
 [  10    4  985    2    6    1    2   10   12    0]
 [   0    0   16  955    0    8    0   10   13    8]
 [   1    1    4    0  941    0    6    1    2   26]
 [   6    2    1   12    2  839   11    1   11    7]
 [  12    3    0    1    4    5  928    0    5    0]
 [   1   10   16    1    3    0    0  977    1   19]
 [   7    4    4    6    6    8    6    8  917    8]
 [   4    7    0    8   15    2    1    5    3  964]]
Global Model Test set: Average loss: 0.0840, Accuracy: 0.9728
Precision: 0.9730, Recall: 0.9728, F1 Score: 0.9728
Confusion Matrix:
[[ 972    0    1    0    0    0    2    1    4    0]
 [   0 1125    2    2    0    0    1    0    5    0]
 [   6    2 1004    2    3    0    1    5    9    0]
 [   0    0    4  985    0    3    0    8    8    2]
 [   1    0    3    0  955    0    4    0    2   17]
 [   5    1    0   10    1  858    5    1    5    6]
 [   8    3    1    1    3    2  936    0    4    0]
 [   1    6   16    0    3    0    0  974    1   27]
 [   4    1    1    6    3    1    2    5  948    3]
 [   5    7    1    8    6    0    0    3    8  971]]
Global Model Test set: Average loss: 0.1456, Accuracy: 0.9526
Precision: 0.9540, Recall: 0.9526, F1 Score: 0.9526
Confusion Matrix:
[[ 968    0    1    2    0    1    4    0    3    1]
 [   0 1123    3    3    0    0    3    0    3    0]
 [   6    0  995    7    4    0    3    4   12    1]
 [   1    0   12  966    0    9    0    6   12    4]
 [   0    0    3    0  918    0    7    0    3   51]
 [   7    1    0   19    3  846    7    0    3    6]
 [  12    3    1    1    5    6  926    0    4    0]
 [   0    7   27    2    7    0    0  898    2   85]
 [   7    4    3   12    4    7    5    4  922    6]
 [   7    7    0   10    7    7    0    2    5  964]]
Global Model Test set: Average loss: 0.0590, Accuracy: 0.9810
Precision: 0.9810, Recall: 0.9810, F1 Score: 0.9810
Confusion Matrix:
[[ 973    0    1    0    0    0    1    1    4    0]
 [   0 1126    2    2    0    0    1    0    4    0]
 [   3    4 1013    1    1    1    0    7    2    0]
 [   0    0    2  993    0    4    0    6    4    1]
 [   1    0    3    0  961    0    4    1    2   10]
 [   3    1    0    5    1  873    4    1    3    1]
 [   7    3    0    1    2    2  940    0    3    0]
 [   1    3   11    1    0    0    0 1006    2    4]
 [   6    1    3    2    1    0    1    3  953    4]
 [   4    5    0    9    8    0    0    6    5  972]]
Global Model Test set: Average loss: 0.0763, Accuracy: 0.9762
Precision: 0.9762, Recall: 0.9762, F1 Score: 0.9762
Confusion Matrix:
[[ 973    0    1    0    0    0    1    1    4    0]
 [   0 1125    2    2    0    0    2    0    4    0]
 [   7    1 1006    2    2    0    1    7    6    0]
 [   1    0    4  991    0    2    0    7    4    1]
 [   1    0    3    0  952    0    6    1    2   17]
 [   3    1    0    6    1  872    3    2    3    1]
 [   9    3    0    1    4    5  933    0    3    0]
 [   1    6   13    3    0    0    0  998    2    5]
 [   6    1    3    3    2    6    3    3  945    2]
 [   5    6    0    9    7    2    0    7    6  967]]
Global Model Test set: Average loss: 0.0440, Accuracy: 0.9852
Precision: 0.9852, Recall: 0.9852, F1 Score: 0.9852
Confusion Matrix:
[[ 971    0    1    0    0    0    3    1    3    1]
 [   0 1126    2    1    0    1    2    0    3    0]
 [   3    3 1017    1    2    0    0    4    2    0]
 [   0    0    2 1000    0    3    0    3    2    0]
 [   0    0    1    0  969    0    4    0    2    6]
 [   3    0    0    3    0  877    4    1    3    1]
 [   6    2    0    0    1    2  945    0    2    0]
 [   1    1   10    1    0    0    0 1013    1    1]
 [   5    1    3    3    1    0    1    3  953    4]
 [   5    4    0    4    6    0    0    6    3  981]]
Global Model Test set: Average loss: 0.0428, Accuracy: 0.9859
Precision: 0.9859, Recall: 0.9859, F1 Score: 0.9859
Confusion Matrix:
[[ 972    0    0    0    0    0    3    1    3    1]
 [   0 1127    2    1    0    0    2    0    3    0]
 [   3    0 1021    0    2    0    0    5    1    0]
 [   0    0    2 1000    0    3    0    3    2    0]
 [   0    0    1    0  967    0    4    0    2    8]
 [   3    0    0    4    0  876    4    1    3    1]
 [   5    2    0    0    1    1  945    0    4    0]
 [   1    1    8    1    0    0    0 1015    1    1]
 [   7    1    3    4    0    0    1    3  951    4]
 [   5    3    0    4    3    2    0    5    2  985]]
Global Model Test set: Average loss: 0.0772, Accuracy: 0.9750
Precision: 0.9751, Recall: 0.9750, F1 Score: 0.9750
Confusion Matrix:
[[ 971    0    1    0    0    0    3    1    4    0]
 [   0 1126    2    2    0    0    1    0    4    0]
 [   6    2 1005    1    3    0    1    6    8    0]
 [   0    0    4  987    0    3    0    8    7    1]
 [   1    0    3    0  954    0    5    1    2   16]
 [   3    1    0    8    1  866    5    1    3    4]
 [   7    3    0    1    3    2  938    0    4    0]
 [   1    6   15    1    1    0    0  984    1   19]
 [   5    1    2    5    2    1    2    4  949    3]
 [   5    7    0   10    6    0    0    4    7  970]]
Global Model Test set: Average loss: 0.0987, Accuracy: 0.9678
Precision: 0.9680, Recall: 0.9678, F1 Score: 0.9678
Confusion Matrix:
[[ 970    0    1    1    0    1    3    1    3    0]
 [   0 1126    2    2    0    0    2    0    3    0]
 [   7    1 1001    4    3    0    2    4    9    1]
 [   1    0    4  982    0    4    0    7    9    3]
 [   1    0    3    0  941    0    7    1    3   26]
 [   5    1    0   15    1  854    7    1    4    4]
 [  12    3    1    1    4    5  929    0    3    0]
 [   2    6   20    2    2    0    0  963    2   31]
 [   5    1    3    8    2    5    3    3  942    2]
 [   6    7    0   10    5    2    0    4    5  970]]
Global Model Test set: Average loss: 0.0645, Accuracy: 0.9791
Precision: 0.9792, Recall: 0.9791, F1 Score: 0.9791
Confusion Matrix:
[[ 972    0    1    0    0    0    2    1    4    0]
 [   0 1126    2    1    0    0    1    0    5    0]
 [   6    0 1008    1    3    0    1    5    8    0]
 [   0    0    2  992    0    3    0    6    6    1]
 [   0    0    2    0  961    0    4    0    2   13]
 [   3    1    0    9    1  864    5    1    5    3]
 [   7    3    0    1    1    2  940    0    4    0]
 [   1    4   13    1    1    0    0  995    1   12]
 [   5    1    1    4    3    0    2    3  953    2]
 [   5    5    0    6    6    0    0    4    3  980]]
Global Model Test set: Average loss: 0.0801, Accuracy: 0.9729
Precision: 0.9732, Recall: 0.9729, F1 Score: 0.9729
Confusion Matrix:
[[ 972    0    0    0    0    0    3    1    4    0]
 [   0 1123    2    1    0    0    3    0    6    0]
 [   7    0 1004    1    3    0    2    5   10    0]
 [   0    0    4  987    0    2    0    5    8    4]
 [   0    0    1    0  958    0    6    0    2   15]
 [   5    0    0   14    2  851    7    1    6    6]
 [   8    3    0    1    2    1  938    0    5    0]
 [   2    6   17    1    2    0    0  970    1   29]
 [   6    1    1    5    3    0    2    3  951    2]
 [   5    5    0    6    6    0    0    4    8  975]]
Global Model Test set: Average loss: 0.0511, Accuracy: 0.9826
Precision: 0.9826, Recall: 0.9826, F1 Score: 0.9826
Confusion Matrix:
[[ 971    0    1    0    0    0    2    1    4    1]
 [   0 1126    2    1    0    0    2    0    4    0]
 [   3    2 1015    2    2    0    0    6    2    0]
 [   0    0    2  998    0    3    0    4    3    0]
 [   0    0    2    0  965    0    4    1    2    8]
 [   3    0    0    5    0  874    4    1    3    2]
 [   6    3    0    1    2    2  940    0    4    0]
 [   1    3   10    1    0    0    0 1009    1    3]
 [   6    1    3    3    1    0    1    3  952    4]
 [   5    5    0    6    7    0    0    6    4  976]]
Global Model Test set: Average loss: 0.0539, Accuracy: 0.9820
Precision: 0.9820, Recall: 0.9820, F1 Score: 0.9820
Confusion Matrix:
[[ 970    0    1    0    0    0    3    1    4    1]
 [   0 1126    2    1    0    0    2    0    4    0]
 [   4    0 1014    1    3    0    0    7    3    0]
 [   0    0    2  995    0    3    0    6    4    0]
 [   0    0    2    0  963    0    5    0    2   10]
 [   3    0    0    6    0  872    4    1    3    3]
 [   7    3    0    1    2    2  940    0    3    0]
 [   1    3   11    1    0    0    0 1008    1    3]
 [   6    1    3    2    1    0    1    3  955    2]
 [   6    4    0    6    6    1    0    5    4  977]]
Global Model Test set: Average loss: 0.0650, Accuracy: 0.9802
Precision: 0.9803, Recall: 0.9802, F1 Score: 0.9802
Confusion Matrix:
[[ 972    0    1    0    0    0    2    1    4    0]
 [   0 1127    2    1    0    0    1    0    4    0]
 [   6    0 1009    1    3    0    1    6    6    0]
 [   0    0    2  993    0    3    0    6    5    1]
 [   1    0    2    0  960    0    4    1    2   12]
 [   3    1    0    6    1  870    5    1    3    2]
 [   7    3    0    1    2    2  939    0    4    0]
 [   1    5   13    1    0    0    0  999    1    8]
 [   6    1    1    3    2    0    2    3  954    2]
 [   5    5    0    6    6    1    0    4    3  979]]
Global Model Test set: Average loss: 0.0739, Accuracy: 0.9759
Precision: 0.9760, Recall: 0.9759, F1 Score: 0.9759
Confusion Matrix:
[[ 971    0    1    0    0    0    3    1    4    0]
 [   0 1125    2    1    0    0    2    0    5    0]
 [   7    0 1006    1    3    0    1    6    8    0]
 [   0    0    4  991    0    3    0    6    5    1]
 [   1    0    2    0  956    0    6    0    2   15]
 [   3    1    0    8    1  865    5    1    5    3]
 [   7    3    0    1    2    2  939    0    4    0]
 [   2    6   17    1    0    0    0  982    1   19]
 [   6    1    1    5    2    1    2    3  951    2]
 [   5    5    0    8    6    1    0    4    7  973]]
Global Model Test set: Average loss: 0.0428, Accuracy: 0.9859
Precision: 0.9859, Recall: 0.9859, F1 Score: 0.9859
Confusion Matrix:
[[ 972    0    0    0    0    0    3    1    3    1]
 [   0 1127    2    1    0    0    2    0    3    0]
 [   3    0 1021    0    2    0    0    5    1    0]
 [   0    0    2 1000    0    3    0    3    2    0]
 [   0    0    1    0  967    0    4    0    2    8]
 [   3    0    0    4    0  876    4    1    3    1]
 [   5    2    0    0    1    1  945    0    4    0]
 [   1    1    8    1    0    0    0 1015    1    1]
 [   7    1    3    4    0    0    1    3  951    4]
 [   5    3    0    4    3    2    0    5    2  985]]
Global Model Test set: Average loss: 0.1313, Accuracy: 0.9602
Precision: 0.9603, Recall: 0.9602, F1 Score: 0.9602
Confusion Matrix:
[[ 970    0    1    0    0    3    3    1    2    0]
 [   0 1126    3    1    0    0    3    0    2    0]
 [  10    4  985    2    6    1    2   10   12    0]
 [   0    0   16  955    0    8    0   10   13    8]
 [   1    1    4    0  941    0    6    1    2   26]
 [   6    2    1   12    2  839   11    1   11    7]
 [  12    3    0    1    4    5  928    0    5    0]
 [   1   10   16    1    3    0    0  977    1   19]
 [   7    4    4    6    6    8    6    8  917    8]
 [   4    7    0    8   15    2    1    5    3  964]]
Global Model Test set: Average loss: 0.0801, Accuracy: 0.9729
Precision: 0.9732, Recall: 0.9729, F1 Score: 0.9729
Confusion Matrix:
[[ 972    0    0    0    0    0    3    1    4    0]
 [   0 1123    2    1    0    0    3    0    6    0]
 [   7    0 1004    1    3    0    2    5   10    0]
 [   0    0    4  987    0    2    0    5    8    4]
 [   0    0    1    0  958    0    6    0    2   15]
 [   5    0    0   14    2  851    7    1    6    6]
 [   8    3    0    1    2    1  938    0    5    0]
 [   2    6   17    1    2    0    0  970    1   29]
 [   6    1    1    5    3    0    2    3  951    2]
 [   5    5    0    6    6    0    0    4    8  975]]
Global Model Test set: Average loss: 0.1456, Accuracy: 0.9526
Precision: 0.9540, Recall: 0.9526, F1 Score: 0.9526
FigureCanvasAgg is non-interactive, and thus cannot be shown
FigureCanvasAgg is non-interactive, and thus cannot be shown
FigureCanvasAgg is non-interactive, and thus cannot be shown
FigureCanvasAgg is non-interactive, and thus cannot be shown
Confusion Matrix:
[[ 968    0    1    2    0    1    4    0    3    1]
 [   0 1123    3    3    0    0    3    0    3    0]
 [   6    0  995    7    4    0    3    4   12    1]
 [   1    0   12  966    0    9    0    6   12    4]
 [   0    0    3    0  918    0    7    0    3   51]
 [   7    1    0   19    3  846    7    0    3    6]
 [  12    3    1    1    5    6  926    0    4    0]
 [   0    7   27    2    7    0    0  898    2   85]
 [   7    4    3   12    4    7    5    4  922    6]
 [   7    7    0   10    7    7    0    2    5  964]]
Global Model Test set: Average loss: 0.0539, Accuracy: 0.9820
Precision: 0.9820, Recall: 0.9820, F1 Score: 0.9820
Confusion Matrix:
[[ 970    0    1    0    0    0    3    1    4    1]
 [   0 1126    2    1    0    0    2    0    4    0]
 [   4    0 1014    1    3    0    0    7    3    0]
 [   0    0    2  995    0    3    0    6    4    0]
 [   0    0    2    0  963    0    5    0    2   10]
 [   3    0    0    6    0  872    4    1    3    3]
 [   7    3    0    1    2    2  940    0    3    0]
 [   1    3   11    1    0    0    0 1008    1    3]
 [   6    1    3    2    1    0    1    3  955    2]
 [   6    4    0    6    6    1    0    5    4  977]]
Global Model Test set: Average loss: 0.0763, Accuracy: 0.9762
Precision: 0.9762, Recall: 0.9762, F1 Score: 0.9762
Confusion Matrix:
[[ 973    0    1    0    0    0    1    1    4    0]
 [   0 1125    2    2    0    0    2    0    4    0]
 [   7    1 1006    2    2    0    1    7    6    0]
 [   1    0    4  991    0    2    0    7    4    1]
 [   1    0    3    0  952    0    6    1    2   17]
 [   3    1    0    6    1  872    3    2    3    1]
 [   9    3    0    1    4    5  933    0    3    0]
 [   1    6   13    3    0    0    0  998    2    5]
 [   6    1    3    3    2    6    3    3  945    2]
 [   5    6    0    9    7    2    0    7    6  967]]
Global Model Test set: Average loss: 0.0440, Accuracy: 0.9852
Precision: 0.9852, Recall: 0.9852, F1 Score: 0.9852
Confusion Matrix:
[[ 971    0    1    0    0    0    3    1    3    1]
 [   0 1126    2    1    0    1    2    0    3    0]
 [   3    3 1017    1    2    0    0    4    2    0]
 [   0    0    2 1000    0    3    0    3    2    0]
 [   0    0    1    0  969    0    4    0    2    6]
 [   3    0    0    3    0  877    4    1    3    1]
 [   6    2    0    0    1    2  945    0    2    0]
 [   1    1   10    1    0    0    0 1013    1    1]
 [   5    1    3    3    1    0    1    3  953    4]
 [   5    4    0    4    6    0    0    6    3  981]]
Global Model Test set: Average loss: 0.0505, Accuracy: 0.9831
Precision: 0.9831, Recall: 0.9831, F1 Score: 0.9831
Confusion Matrix:
[[ 971    0    1    0    0    0    3    1    3    1]
 [   0 1128    2    1    0    1    1    0    2    0]
 [   2    4 1016    1    1    1    0    5    2    0]
 [   0    0    2  998    0    4    0    4    2    0]
 [   0    0    3    0  965    0    4    2    1    7]
 [   3    1    0    5    1  872    5    1    3    1]
 [   5    3    1    1    2    3  941    0    2    0]
 [   1    2   10    1    0    0    0 1011    1    2]
 [   4    0    2    3    2    0    0    4  954    5]
 [   4    5    0    6    7    0    0    9    3  975]]
Global Model Test set: Average loss: 0.0739, Accuracy: 0.9759
Precision: 0.9760, Recall: 0.9759, F1 Score: 0.9759
Confusion Matrix:
[[ 971    0    1    0    0    0    3    1    4    0]
 [   0 1125    2    1    0    0    2    0    5    0]
 [   7    0 1006    1    3    0    1    6    8    0]
 [   0    0    4  991    0    3    0    6    5    1]
 [   1    0    2    0  956    0    6    0    2   15]
 [   3    1    0    8    1  865    5    1    5    3]
 [   7    3    0    1    2    2  939    0    4    0]
 [   2    6   17    1    0    0    0  982    1   19]
 [   6    1    1    5    2    1    2    3  951    2]
 [   5    5    0    8    6    1    0    4    7  973]]
Global Model Test set: Average loss: 0.0987, Accuracy: 0.9678
Precision: 0.9680, Recall: 0.9678, F1 Score: 0.9678
Confusion Matrix:
[[ 970    0    1    1    0    1    3    1    3    0]
 [   0 1126    2    2    0    0    2    0    3    0]
 [   7    1 1001    4    3    0    2    4    9    1]
 [   1    0    4  982    0    4    0    7    9    3]
 [   1    0    3    0  941    0    7    1    3   26]
 [   5    1    0   15    1  854    7    1    4    4]
 [  12    3    1    1    4    5  929    0    3    0]
 [   2    6   20    2    2    0    0  963    2   31]
 [   5    1    3    8    2    5    3    3  942    2]
 [   6    7    0   10    5    2    0    4    5  970]]
Global Model Test set: Average loss: 0.0645, Accuracy: 0.9791
Precision: 0.9792, Recall: 0.9791, F1 Score: 0.9791
Confusion Matrix:
[[ 972    0    1    0    0    0    2    1    4    0]
 [   0 1126    2    1    0    0    1    0    5    0]
 [   6    0 1008    1    3    0    1    5    8    0]
 [   0    0    2  992    0    3    0    6    6    1]
 [   0    0    2    0  961    0    4    0    2   13]
 [   3    1    0    9    1  864    5    1    5    3]
 [   7    3    0    1    1    2  940    0    4    0]
 [   1    4   13    1    1    0    0  995    1   12]
 [   5    1    1    4    3    0    2    3  953    2]
 [   5    5    0    6    6    0    0    4    3  980]]
Global Model Test set: Average loss: 0.0840, Accuracy: 0.9728
Precision: 0.9730, Recall: 0.9728, F1 Score: 0.9728
Confusion Matrix:
[[ 972    0    1    0    0    0    2    1    4    0]
 [   0 1125    2    2    0    0    1    0    5    0]
 [   6    2 1004    2    3    0    1    5    9    0]
 [   0    0    4  985    0    3    0    8    8    2]
 [   1    0    3    0  955    0    4    0    2   17]
 [   5    1    0   10    1  858    5    1    5    6]
 [   8    3    1    1    3    2  936    0    4    0]
 [   1    6   16    0    3    0    0  974    1   27]
 [   4    1    1    6    3    1    2    5  948    3]
 [   5    7    1    8    6    0    0    3    8  971]]
Global Model Test set: Average loss: 0.0511, Accuracy: 0.9826
Precision: 0.9826, Recall: 0.9826, F1 Score: 0.9826
Confusion Matrix:
[[ 971    0    1    0    0    0    2    1    4    1]
 [   0 1126    2    1    0    0    2    0    4    0]
 [   3    2 1015    2    2    0    0    6    2    0]
 [   0    0    2  998    0    3    0    4    3    0]
 [   0    0    2    0  965    0    4    1    2    8]
 [   3    0    0    5    0  874    4    1    3    2]
 [   6    3    0    1    2    2  940    0    4    0]
 [   1    3   10    1    0    0    0 1009    1    3]
 [   6    1    3    3    1    0    1    3  952    4]
 [   5    5    0    6    7    0    0    6    4  976]]
Global Model Test set: Average loss: 0.0590, Accuracy: 0.9810
Precision: 0.9810, Recall: 0.9810, F1 Score: 0.9810
Confusion Matrix:
[[ 973    0    1    0    0    0    1    1    4    0]
 [   0 1126    2    2    0    0    1    0    4    0]
 [   3    4 1013    1    1    1    0    7    2    0]
 [   0    0    2  993    0    4    0    6    4    1]
 [   1    0    3    0  961    0    4    1    2   10]
 [   3    1    0    5    1  873    4    1    3    1]
 [   7    3    0    1    2    2  940    0    3    0]
 [   1    3   11    1    0    0    0 1006    2    4]
 [   6    1    3    2    1    0    1    3  953    4]
 [   4    5    0    9    8    0    0    6    5  972]]
Global Model Test set: Average loss: 0.0650, Accuracy: 0.9802
Precision: 0.9803, Recall: 0.9802, F1 Score: 0.9802
Confusion Matrix:
[[ 972    0    1    0    0    0    2    1    4    0]
 [   0 1127    2    1    0    0    1    0    4    0]
 [   6    0 1009    1    3    0    1    6    6    0]
 [   0    0    2  993    0    3    0    6    5    1]
 [   1    0    2    0  960    0    4    1    2   12]
 [   3    1    0    6    1  870    5    1    3    2]
 [   7    3    0    1    2    2  939    0    4    0]
 [   1    5   13    1    0    0    0  999    1    8]
 [   6    1    1    3    2    0    2    3  954    2]
 [   5    5    0    6    6    1    0    4    3  979]]
Global Model Test set: Average loss: 0.0772, Accuracy: 0.9750
Precision: 0.9751, Recall: 0.9750, F1 Score: 0.9750
Confusion Matrix:
[[ 971    0    1    0    0    0    3    1    4    0]
 [   0 1126    2    2    0    0    1    0    4    0]
 [   6    2 1005    1    3    0    1    6    8    0]
 [   0    0    4  987    0    3    0    8    7    1]
 [   1    0    3    0  954    0    5    1    2   16]
 [   3    1    0    8    1  866    5    1    3    4]
 [   7    3    0    1    3    2  938    0    4    0]
 [   1    6   15    1    1    0    0  984    1   19]
 [   5    1    2    5    2    1    2    4  949    3]
 [   5    7    0   10    6    0    0    4    7  970]]
Shapley Values for round 1: {0: -0.006658333333333358, 1: 0.005258333333333309, 2: 0.009991666666666638, 3: 0.011408333333333319}
Incentives allocated: {'0': -3329.1666666666947, '1': 2629.166666666667, '2': 4995.833333333343, '3': 5704.166666666686}

FL Training Round 2/2

Training client 0 model...
Epoch 1/10, Loss: 0.1318
Epoch 2/10, Loss: 0.1196
Epoch 3/10, Loss: 0.1166
Epoch 4/10, Loss: 0.0995
Epoch 5/10, Loss: 0.0979
Epoch 6/10, Loss: 0.0967
Epoch 7/10, Loss: 0.0834
Epoch 8/10, Loss: 0.0848
Epoch 9/10, Loss: 0.0770
Epoch 10/10, Loss: 0.0781

Evaluating client 0 model...
Test set: Loss: 0.0546, Accuracy: 0.9826, Precision: 0.9827, Recall: 0.9826, F1: 0.9826
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1126    4    1    0    0    2    0    2    0]
 [   2    2 1022    0    1    0    0    5    0    0]
 [   0    0    3  998    0    1    0    5    3    0]
 [   0    0    2    0  970    0    5    0    2    3]
 [   2    0    0    5    0  879    3    1    2    0]
 [   7    3    1    1    1    2  942    0    1    0]
 [   1    3   17    1    0    0    0 1004    1    1]
 [   6    1    5    5    4    2    1    6  943    1]
 [   5    6    0    7   10    2    0    7    3  969]]

Training client 1 model...
Epoch 1/10, Loss: 0.1012
Epoch 2/10, Loss: 0.0933
Epoch 3/10, Loss: 0.0860
Epoch 4/10, Loss: 0.0760
Epoch 5/10, Loss: 0.0724
Epoch 6/10, Loss: 0.0719
Epoch 7/10, Loss: 0.0684
Epoch 8/10, Loss: 0.0632
Epoch 9/10, Loss: 0.0630
Epoch 10/10, Loss: 0.0607

Evaluating client 1 model...
Test set: Loss: 0.0439, Accuracy: 0.9847, Precision: 0.9847, Recall: 0.9847, F1: 0.9847
Confusion Matrix:
[[ 972    0    2    0    0    0    2    1    3    0]
 [   0 1125    3    0    0    1    2    0    4    0]
 [   2    2 1021    2    0    0    0    4    1    0]
 [   0    0    2  999    0    3    0    4    2    0]
 [   0    0    2    0  967    0    3    0    3    7]
 [   2    0    0    4    0  880    4    0    2    0]
 [   6    3    1    1    3    3  939    0    2    0]
 [   1    3   10    1    0    0    0 1011    1    1]
 [   4    1    3    2    0    0    1    2  958    3]
 [   4    4    0    6    7    3    0    5    5  975]]

Training client 2 model...
Epoch 1/10, Loss: 0.0833
Epoch 2/10, Loss: 0.0727
Epoch 3/10, Loss: 0.0706
Epoch 4/10, Loss: 0.0683
Epoch 5/10, Loss: 0.0636
Epoch 6/10, Loss: 0.0585
Epoch 7/10, Loss: 0.0556
Epoch 8/10, Loss: 0.0554
Epoch 9/10, Loss: 0.0515
Epoch 10/10, Loss: 0.0503

Evaluating client 2 model...
Test set: Loss: 0.0375, Accuracy: 0.9867, Precision: 0.9867, Recall: 0.9867, F1: 0.9867
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1128    2    1    0    1    1    0    2    0]
 [   2    1 1025    1    1    0    0    2    0    0]
 [   0    0    2 1000    0    3    0    3    1    1]
 [   0    0    1    0  964    0    2    0    1   14]
 [   2    0    0    7    0  879    2    0    2    0]
 [   8    2    0    0    3    1  938    0    6    0]
 [   1    0    8    1    0    0    0 1013    1    4]
 [   3    0    3    1    0    1    0    3  958    5]
 [   5    2    0    4    3    1    0    4    2  988]]

Training client 3 model...
Epoch 1/10, Loss: 0.0858
Epoch 2/10, Loss: 0.0721
Epoch 3/10, Loss: 0.0678
Epoch 4/10, Loss: 0.0662
Epoch 5/10, Loss: 0.0598
Epoch 6/10, Loss: 0.0565
Epoch 7/10, Loss: 0.0525
Epoch 8/10, Loss: 0.0490
Epoch 9/10, Loss: 0.0459
Epoch 10/10, Loss: 0.0490

Evaluating client 3 model...
Test set: Loss: 0.0343, Accuracy: 0.9885, Precision: 0.9885, Recall: 0.9885, F1: 0.9885
Confusion Matrix:
[[ 974    0    0    0    0    0    2    1    3    0]
 [   0 1128    1    1    0    1    2    1    1    0]
 [   2    1 1024    0    1    0    0    4    0    0]
 [   0    0    2 1003    0    2    0    2    1    0]
 [   0    0    1    0  972    0    3    0    1    5]
 [   2    0    0    6    0  881    3    0    0    0]
 [   5    2    0    0    1    4  945    0    1    0]
 [   1    1    8    0    0    0    0 1016    1    1]
 [   5    1    2    0    0    1    0    3  956    6]
 [   3    3    0    4    3    2    0    5    3  986]]
Aggregation explanation for round 1 saved successfully.
Global Model Test set: Average loss: 0.0343, Accuracy: 0.9885
Precision: 0.9885, Recall: 0.9885, F1 Score: 0.9885
Confusion Matrix:
[[ 974    0    0    0    0    0    2    1    3    0]
 [   0 1128    1    1    0    1    2    1    1    0]
 [   2    1 1024    0    1    0    0    4    0    0]
 [   0    0    2 1003    0    2    0    2    1    0]
 [   0    0    1    0  972    0    3    0    1    5]
 [   2    0    0    6    0  881    3    0    0    0]
 [   5    2    0    0    1    4  945    0    1    0]
 [   1    1    8    0    0    0    0 1016    1    1]
 [   5    1    2    0    0    1    0    3  956    6]
 [   3    3    0    4    3    2    0    5    3  986]]
Global Model Test set: Average loss: 0.0343, Accuracy: 0.9885
Precision: 0.9885, Recall: 0.9885, F1 Score: 0.9885
Confusion Matrix:
[[ 974    0    0    0    0    0    2    1    3    0]
 [   0 1128    1    1    0    1    2    1    1    0]
 [   2    1 1024    0    1    0    0    4    0    0]
 [   0    0    2 1003    0    2    0    2    1    0]
 [   0    0    1    0  972    0    3    0    1    5]
 [   2    0    0    6    0  881    3    0    0    0]
 [   5    2    0    0    1    4  945    0    1    0]
 [   1    1    8    0    0    0    0 1016    1    1]
 [   5    1    2    0    0    1    0    3  956    6]
 [   3    3    0    4    3    2    0    5    3  986]]
Global Model Test set: Average loss: 0.0343, Accuracy: 0.9885
Precision: 0.9885, Recall: 0.9885, F1 Score: 0.9885
Confusion Matrix:
[[ 974    0    0    0    0    0    2    1    3    0]
 [   0 1128    1    1    0    1    2    1    1    0]
 [   2    1 1024    0    1    0    0    4    0    0]
 [   0    0    2 1003    0    2    0    2    1    0]
 [   0    0    1    0  972    0    3    0    1    5]
 [   2    0    0    6    0  881    3    0    0    0]
 [   5    2    0    0    1    4  945    0    1    0]
 [   1    1    8    0    0    0    0 1016    1    1]
 [   5    1    2    0    0    1    0    3  956    6]
 [   3    3    0    4    3    2    0    5    3  986]]
Global Model Test set: Average loss: 0.0546, Accuracy: 0.9826
Precision: 0.9827, Recall: 0.9826, F1 Score: 0.9826
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1126    4    1    0    0    2    0    2    0]
 [   2    2 1022    0    1    0    0    5    0    0]
 [   0    0    3  998    0    1    0    5    3    0]
 [   0    0    2    0  970    0    5    0    2    3]
 [   2    0    0    5    0  879    3    1    2    0]
 [   7    3    1    1    1    2  942    0    1    0]
 [   1    3   17    1    0    0    0 1004    1    1]
 [   6    1    5    5    4    2    1    6  943    1]
 [   5    6    0    7   10    2    0    7    3  969]]
Global Model Test set: Average loss: 0.0473, Accuracy: 0.9833
Precision: 0.9833, Recall: 0.9833, F1 Score: 0.9833
Confusion Matrix:
[[ 974    0    0    0    0    0    3    1    2    0]
 [   0 1124    2    1    0    0    5    0    3    0]
 [   3    3 1006    2    2    0    0   12    4    0]
 [   0    0    1 1002    0    3    0    1    2    1]
 [   0    0    2    0  969    0    3    0    2    6]
 [   2    0    0    5    1  875    4    1    2    2]
 [   3    2    0    1    2    1  946    0    3    0]
 [   1    5    5    2    1    0    0 1007    2    5]
 [   4    1    1    2    3    1    1    3  953    5]
 [   2    5    0    5    9    2    0    6    3  977]]
Global Model Test set: Average loss: 0.0454, Accuracy: 0.9848
Precision: 0.9848, Recall: 0.9848, F1 Score: 0.9848
Confusion Matrix:
[[ 972    0    2    0    0    0    3    1    2    0]
 [   0 1127    4    0    0    1    1    0    2    0]
 [   2    2 1021    0    1    0    0    5    1    0]
 [   0    0    2 1001    0    1    0    4    2    0]
 [   0    0    2    0  968    0    4    0    2    6]
 [   2    0    0    4    0  879    4    1    2    0]
 [   7    3    1    1    2    3  939    0    2    0]
 [   1    3   10    1    0    0    0 1011    1    1]
 [   5    1    3    3    1    1    1    3  954    2]
 [   4    5    0    5    8    3    0    5    3  976]]
Global Model Test set: Average loss: 0.0439, Accuracy: 0.9847
Precision: 0.9847, Recall: 0.9847, F1 Score: 0.9847
Confusion Matrix:
[[ 972    0    2    0    0    0    2    1    3    0]
 [   0 1125    3    0    0    1    2    0    4    0]
 [   2    2 1021    2    0    0    0    4    1    0]
 [   0    0    2  999    0    3    0    4    2    0]
 [   0    0    2    0  967    0    3    0    3    7]
 [   2    0    0    4    0  880    4    0    2    0]
 [   6    3    1    1    3    3  939    0    2    0]
 [   1    3   10    1    0    0    0 1011    1    1]
 [   4    1    3    2    0    0    1    2  958    3]
 [   4    4    0    6    7    3    0    5    5  975]]
Global Model Test set: Average loss: 0.0411, Accuracy: 0.9867
Precision: 0.9867, Recall: 0.9867, F1 Score: 0.9867
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1128    3    0    0    1    1    0    2    0]
 [   2    2 1022    1    1    0    0    4    0    0]
 [   0    0    2 1001    0    2    0    3    2    0]
 [   0    0    1    0  968    0    2    0    2    9]
 [   2    0    0    5    0  881    2    0    2    0]
 [   7    3    1    1    3    1  939    0    3    0]
 [   1    2    9    1    0    0    0 1011    2    2]
 [   4    0    3    0    1    1    0    3  958    4]
 [   4    3    0    5    4    0    0    5    3  985]]
Global Model Test set: Average loss: 0.0375, Accuracy: 0.9867
Precision: 0.9867, Recall: 0.9867, F1 Score: 0.9867
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1128    2    1    0    1    1    0    2    0]
 [   2    1 1025    1    1    0    0    2    0    0]
 [   0    0    2 1000    0    3    0    3    1    1]
 [   0    0    1    0  964    0    2    0    1   14]
 [   2    0    0    7    0  879    2    0    2    0]
 [   8    2    0    0    3    1  938    0    6    0]
 [   1    0    8    1    0    0    0 1013    1    4]
 [   3    0    3    1    0    1    0    3  958    5]
 [   5    2    0    4    3    1    0    4    2  988]]
Global Model Test set: Average loss: 0.0389, Accuracy: 0.9872
Precision: 0.9872, Recall: 0.9872, F1 Score: 0.9872
Confusion Matrix:
[[ 972    0    1    0    0    0    3    1    3    0]
 [   0 1128    3    1    0    0    1    0    2    0]
 [   2    1 1023    0    1    0    0    5    0    0]
 [   0    0    2 1003    0    1    0    3    1    0]
 [   0    0    1    0  970    0    4    0    2    5]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    2    0    0    1    2  945    0    2    0]
 [   1    1   10    0    0    0    0 1014    1    1]
 [   4    1    3    3    1    0    1    4  954    3]
 [   4    4    0    4    7    0    0    6    3  981]]
Global Model Test set: Average loss: 0.0343, Accuracy: 0.9885
Precision: 0.9885, Recall: 0.9885, F1 Score: 0.9885
Confusion Matrix:
[[ 974    0    0    0    0    0    2    1    3    0]
 [   0 1128    1    1    0    1    2    1    1    0]
 [   2    1 1024    0    1    0    0    4    0    0]
 [   0    0    2 1003    0    2    0    2    1    0]
 [   0    0    1    0  972    0    3    0    1    5]
 [   2    0    0    6    0  881    3    0    0    0]
 [   5    2    0    0    1    4  945    0    1    0]
 [   1    1    8    0    0    0    0 1016    1    1]
 [   5    1    2    0    0    1    0    3  956    6]
 [   3    3    0    4    3    2    0    5    3  986]]
Global Model Test set: Average loss: 0.0403, Accuracy: 0.9868
Precision: 0.9868, Recall: 0.9868, F1 Score: 0.9868
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1128    3    0    0    1    1    0    2    0]
 [   2    2 1021    1    1    0    0    5    0    0]
 [   0    0    2 1000    0    2    0    4    2    0]
 [   0    0    1    0  968    0    2    0    2    9]
 [   2    0    0    4    0  881    2    1    2    0]
 [   6    3    1    1    3    2  940    0    2    0]
 [   1    1    8    1    0    0    0 1015    1    1]
 [   4    0    3    0    0    0    1    3  960    3]
 [   5    3    0    5    5    2    0    5    3  981]]
Global Model Test set: Average loss: 0.0378, Accuracy: 0.9868
Precision: 0.9868, Recall: 0.9868, F1 Score: 0.9868
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1128    3    0    0    1    1    0    2    0]
 [   2    2 1023    1    1    0    0    3    0    0]
 [   0    0    2 1001    0    2    0    3    2    0]
 [   0    0    1    0  966    0    2    0    2   11]
 [   2    0    0    6    0  880    2    0    2    0]
 [   6    3    0    1    3    3  938    0    4    0]
 [   1    0    8    1    0    0    0 1016    1    1]
 [   4    0    3    0    0    0    1    3  960    3]
 [   5    3    0    4    4    2    0    5    4  982]]
Global Model Test set: Average loss: 0.0389, Accuracy: 0.9870
Precision: 0.9870, Recall: 0.9870, F1 Score: 0.9870
Confusion Matrix:
[[ 972    0    1    0    0    0    3    1    3    0]
 [   0 1128    4    0    0    0    1    0    2    0]
 [   2    1 1023    0    1    0    0    5    0    0]
 [   0    0    2 1001    0    2    0    3    2    0]
 [   0    0    1    0  971    0    3    0    2    5]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    3    0    1    2    3  941    0    2    0]
 [   1    1    9    0    0    0    0 1015    1    1]
 [   4    1    3    2    0    0    1    3  957    3]
 [   4    4    0    4    6    3    0    5    3  980]]
Global Model Test set: Average loss: 0.0359, Accuracy: 0.9876
Precision: 0.9876, Recall: 0.9876, F1 Score: 0.9876
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1128    1    1    0    1    2    0    2    0]
 [   2    1 1023    0    1    0    0    5    0    0]
 [   0    0    2 1001    0    3    0    3    1    0]
 [   0    0    1    0  970    0    3    0    2    6]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    2    0    0    3    2  943    0    2    0]
 [   1    1    7    0    0    0    0 1017    1    1]
 [   4    1    2    2    0    0    1    3  957    4]
 [   4    3    0    4    5    2    0    5    4  982]]
Global Model Test set: Average loss: 0.0364, Accuracy: 0.9886
Precision: 0.9886, Recall: 0.9886, F1 Score: 0.9886
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1128    2    1    0    1    1    0    2    0]
 [   2    1 1024    0    1    0    0    4    0    0]
 [   0    0    2 1002    0    2    0    3    1    0]
 [   0    0    1    0  971    0    2    0    2    6]
 [   2    0    0    5    0  881    2    0    2    0]
 [   6    2    0    0    1    1  946    0    2    0]
 [   1    0    8    0    0    0    0 1017    1    1]
 [   4    0    3    0    0    1    0    3  960    3]
 [   5    2    0    4    5    1    0    5    3  984]]
Global Model Test set: Average loss: 0.0331, Accuracy: 0.9886
Precision: 0.9886, Recall: 0.9886, F1 Score: 0.9886
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1129    1    1    0    1    2    0    1    0]
 [   2    0 1026    0    1    0    0    3    0    0]
 [   0    0    2 1002    0    2    0    3    1    0]
 [   0    0    1    0  967    0    3    0    1   10]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    2    0    0    3    3  942    0    2    0]
 [   1    0    6    0    0    0    0 1019    1    1]
 [   4    0    3    0    0    1    0    3  958    5]
 [   5    2    0    4    3    1    0    5    2  987]]
Global Model Test set: Average loss: 0.0370, Accuracy: 0.9874
Precision: 0.9874, Recall: 0.9874, F1 Score: 0.9874
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1128    3    0    0    1    1    0    2    0]
 [   2    2 1023    0    1    0    0    4    0    0]
 [   0    0    2 1001    0    2    0    3    2    0]
 [   0    0    1    0  970    0    2    0    2    7]
 [   2    0    0    5    0  881    2    0    2    0]
 [   6    3    0    1    3    3  940    0    2    0]
 [   1    0    9    1    0    0    0 1015    1    1]
 [   4    0    3    0    0    0    1    3  960    3]
 [   4    3    0    4    6    1    0    5    3  983]]
Global Model Test set: Average loss: 0.0347, Accuracy: 0.9880
Precision: 0.9880, Recall: 0.9880, F1 Score: 0.9880
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1128    2    1    0    1    1    0    2    0]
 [   2    1 1025    0    1    0    0    3    0    0]
 [   0    0    2 1002    0    2    0    3    1    0]
 [   0    0    1    0  968    0    2    0    2    9]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    2    0    0    3    2  942    0    3    0]
 [   1    0    9    0    0    0    0 1016    1    1]
 [   4    0    3    0    0    1    0    3  959    4]
 [   4    2    0    4    5    1    0    5    3  985]]
Global Model Test set: Average loss: 0.0439, Accuracy: 0.9847
Precision: 0.9847, Recall: 0.9847, F1 Score: 0.9847
Confusion Matrix:
[[ 972    0    2    0    0    0    2    1    3    0]
 [   0 1125    3    0    0    1    2    0    4    0]
 [   2    2 1021    2    0    0    0    4    1    0]
 [   0    0    2  999    0    3    0    4    2    0]
 [   0    0    2    0  967    0    3    0    3    7]
 [   2    0    0    4    0  880    4    0    2    0]
 [   6    3    1    1    3    3  939    0    2    0]
 [   1    3   10    1    0    0    0 1011    1    1]
 [   4    1    3    2    0    0    1    2  958    3]
 [   4    4    0    6    7    3    0    5    5  975]]
Global Model Test set: Average loss: 0.0473, Accuracy: 0.9833
Precision: 0.9833, Recall: 0.9833, F1 Score: 0.9833
Confusion Matrix:
[[ 974    0    0    0    0    0    3    1    2    0]
 [   0 1124    2    1    0    0    5    0    3    0]
 [   3    3 1006    2    2    0    0   12    4    0]
 [   0    0    1 1002    0    3    0    1    2    1]
 [   0    0    2    0  969    0    3    0    2    6]
 [   2    0    0    5    1  875    4    1    2    2]
 [   3    2    0    1    2    1  946    0    3    0]
 [   1    5    5    2    1    0    0 1007    2    5]
 [   4    1    1    2    3    1    1    3  953    5]
 [   2    5    0    5    9    2    0    6    3  977]]
Global Model Test set: Average loss: 0.0454, Accuracy: 0.9848
Precision: 0.9848, Recall: 0.9848, F1 Score: 0.9848
Confusion Matrix:
[[ 972    0    2    0    0    0    3    1    2    0]
 [   0 1127    4    0    0    1    1    0    2    0]
 [   2    2 1021    0    1    0    0    5    1    0]
 [   0    0    2 1001    0    1    0    4    2    0]
 [   0    0    2    0  968    0    4    0    2    6]
 [   2    0    0    4    0  879    4    1    2    0]
 [   7    3    1    1    2    3  939    0    2    0]
 [   1    3   10    1    0    0    0 1011    1    1]
 [   5    1    3    3    1    1    1    3  954    2]
 [   4    5    0    5    8    3    0    5    3  976]]
Global Model Test set: Average loss: 0.0546, Accuracy: 0.9826
Precision: 0.9827, Recall: 0.9826, F1 Score: 0.9826
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1126    4    1    0    0    2    0    2    0]
 [   2    2 1022    0    1    0    0    5    0    0]
 [   0    0    3  998    0    1    0    5    3    0]
 [   0    0    2    0  970    0    5    0    2    3]
 [   2    0    0    5    0  879    3    1    2    0]
 [   7    3    1    1    1    2  942    0    1    0]
 [   1    3   17    1    0    0    0 1004    1    1]
 [   6    1    5    5    4    2    1    6  943    1]
 [   5    6    0    7   10    2    0    7    3  969]]
Global Model Test set: Average loss: 0.0378, Accuracy: 0.9868
Precision: 0.9868, Recall: 0.9868, F1 Score: 0.9868
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1128    3    0    0    1    1    0    2    0]
 [   2    2 1023    1    1    0    0    3    0    0]
 [   0    0    2 1001    0    2    0    3    2    0]
 [   0    0    1    0  966    0    2    0    2   11]
 [   2    0    0    6    0  880    2    0    2    0]
 [   6    3    0    1    3    3  938    0    4    0]
 [   1    0    8    1    0    0    0 1016    1    1]
 [   4    0    3    0    0    0    1    3  960    3]
 [   5    3    0    4    4    2    0    5    4  982]]
Global Model Test set: Average loss: 0.0375, Accuracy: 0.9867
Precision: 0.9867, Recall: 0.9867, F1 Score: 0.9867
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1128    2    1    0    1    1    0    2    0]
 [   2    1 1025    1    1    0    0    2    0    0]
 [   0    0    2 1000    0    3    0    3    1    1]
 [   0    0    1    0  964    0    2    0    1   14]
 [   2    0    0    7    0  879    2    0    2    0]
 [   8    2    0    0    3    1  938    0    6    0]
 [   1    0    8    1    0    0    0 1013    1    4]
 [   3    0    3    1    0    1    0    3  958    5]
 [   5    2    0    4    3    1    0    4    2  988]]
Global Model Test set: Average loss: 0.0359, Accuracy: 0.9876
Precision: 0.9876, Recall: 0.9876, F1 Score: 0.9876
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1128    1    1    0    1    2    0    2    0]
 [   2    1 1023    0    1    0    0    5    0    0]
 [   0    0    2 1001    0    3    0    3    1    0]
 [   0    0    1    0  970    0    3    0    2    6]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    2    0    0    3    2  943    0    2    0]
 [   1    1    7    0    0    0    0 1017    1    1]
 [   4    1    2    2    0    0    1    3  957    4]
 [   4    3    0    4    5    2    0    5    4  982]]
Global Model Test set: Average loss: 0.0343, Accuracy: 0.9885
Precision: 0.9885, Recall: 0.9885, F1 Score: 0.9885
Confusion Matrix:
[[ 974    0    0    0    0    0    2    1    3    0]
 [   0 1128    1    1    0    1    2    1    1    0]
 [   2    1 1024    0    1    0    0    4    0    0]
 [   0    0    2 1003    0    2    0    2    1    0]
 [   0    0    1    0  972    0    3    0    1    5]
 [   2    0    0    6    0  881    3    0    0    0]
 [   5    2    0    0    1    4  945    0    1    0]
 [   1    1    8    0    0    0    0 1016    1    1]
 [   5    1    2    0    0    1    0    3  956    6]
 [   3    3    0    4    3    2    0    5    3  986]]
Global Model Test set: Average loss: 0.0403, Accuracy: 0.9868
Precision: 0.9868, Recall: 0.9868, F1 Score: 0.9868
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1128    3    0    0    1    1    0    2    0]
 [   2    2 1021    1    1    0    0    5    0    0]
 [   0    0    2 1000    0    2    0    4    2    0]
 [   0    0    1    0  968    0    2    0    2    9]
 [   2    0    0    4    0  881    2    1    2    0]
 [   6    3    1    1    3    2  940    0    2    0]
 [   1    1    8    1    0    0    0 1015    1    1]
 [   4    0    3    0    0    0    1    3  960    3]
 [   5    3    0    5    5    2    0    5    3  981]]
Global Model Test set: Average loss: 0.0411, Accuracy: 0.9867
Precision: 0.9867, Recall: 0.9867, F1 Score: 0.9867
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1128    3    0    0    1    1    0    2    0]
 [   2    2 1022    1    1    0    0    4    0    0]
 [   0    0    2 1001    0    2    0    3    2    0]
 [   0    0    1    0  968    0    2    0    2    9]
 [   2    0    0    5    0  881    2    0    2    0]
 [   7    3    1    1    3    1  939    0    3    0]
 [   1    2    9    1    0    0    0 1011    2    2]
 [   4    0    3    0    1    1    0    3  958    4]
 [   4    3    0    5    4    0    0    5    3  985]]
Global Model Test set: Average loss: 0.0389, Accuracy: 0.9870
Precision: 0.9870, Recall: 0.9870, F1 Score: 0.9870
Confusion Matrix:
[[ 972    0    1    0    0    0    3    1    3    0]
 [   0 1128    4    0    0    0    1    0    2    0]
 [   2    1 1023    0    1    0    0    5    0    0]
 [   0    0    2 1001    0    2    0    3    2    0]
 [   0    0    1    0  971    0    3    0    2    5]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    3    0    1    2    3  941    0    2    0]
 [   1    1    9    0    0    0    0 1015    1    1]
 [   4    1    3    2    0    0    1    3  957    3]
 [   4    4    0    4    6    3    0    5    3  980]]
Global Model Test set: Average loss: 0.0389, Accuracy: 0.9872
Precision: 0.9872, Recall: 0.9872, F1 Score: 0.9872
Confusion Matrix:
[[ 972    0    1    0    0    0    3    1    3    0]
 [   0 1128    3    1    0    0    1    0    2    0]
 [   2    1 1023    0    1    0    0    5    0    0]
 [   0    0    2 1003    0    1    0    3    1    0]
 [   0    0    1    0  970    0    4    0    2    5]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    2    0    0    1    2  945    0    2    0]
 [   1    1   10    0    0    0    0 1014    1    1]
 [   4    1    3    3    1    0    1    4  954    3]
 [   4    4    0    4    7    0    0    6    3  981]]
Global Model Test set: Average loss: 0.0347, Accuracy: 0.9880
Precision: 0.9880, Recall: 0.9880, F1 Score: 0.9880
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1128    2    1    0    1    1    0    2    0]
 [   2    1 1025    0    1    0    0    3    0    0]
 [   0    0    2 1002    0    2    0    3    1    0]
 [   0    0    1    0  968    0    2    0    2    9]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    2    0    0    3    2  942    0    3    0]
 [   1    0    9    0    0    0    0 1016    1    1]
 [   4    0    3    0    0    1    0    3  959    4]
 [   4    2    0    4    5    1    0    5    3  985]]
Global Model Test set: Average loss: 0.0331, Accuracy: 0.9886
Precision: 0.9886, Recall: 0.9886, F1 Score: 0.9886
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1129    1    1    0    1    2    0    1    0]
 [   2    0 1026    0    1    0    0    3    0    0]
 [   0    0    2 1002    0    2    0    3    1    0]
 [   0    0    1    0  967    0    3    0    1   10]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    2    0    0    3    3  942    0    2    0]
 [   1    0    6    0    0    0    0 1019    1    1]
 [   4    0    3    0    0    1    0    3  958    5]
 [   5    2    0    4    3    1    0    5    2  987]]
Global Model Test set: Average loss: 0.0370, Accuracy: 0.9874
Precision: 0.9874, Recall: 0.9874, F1 Score: 0.9874
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1128    3    0    0    1    1    0    2    0]
 [   2    2 1023    0    1    0    0    4    0    0]
 [   0    0    2 1001    0    2    0    3    2    0]
 [   0    0    1    0  970    0    2    0    2    7]
 [   2    0    0    5    0  881    2    0    2    0]
 [   6    3    0    1    3    3  940    0    2    0]
 [   1    0    9    1    0    0    0 1015    1    1]
 [   4    0    3    0    0    0    1    3  960    3]
 [   4    3    0    4    6    1    0    5    3  983]]
Global Model Test set: Average loss: 0.0364, Accuracy: 0.9886
Precision: 0.9886, Recall: 0.9886, F1 Score: 0.9886
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1128    2    1    0    1    1    0    2    0]
 [   2    1 1024    0    1    0    0    4    0    0]
 [   0    0    2 1002    0    2    0    3    1    0]
 [   0    0    1    0  971    0    2    0    2    6]
 [   2    0    0    5    0  881    2    0    2    0]
 [   6    2    0    0    1    1  946    0    2    0]
 [   1    0    8    0    0    0    0 1017    1    1]
 [   4    0    3    0    0    1    0    3  960    3]
 [   5    2    0    4    5    1    0    5    3  984]]
Global Model Test set: Average loss: 0.0375, Accuracy: 0.9867
Precision: 0.9867, Recall: 0.9867, F1 Score: 0.9867
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1128    2    1    0    1    1    0    2    0]
 [   2    1 1025    1    1    0    0    2    0    0]
 [   0    0    2 1000    0    3    0    3    1    1]
 [   0    0    1    0  964    0    2    0    1   14]
 [   2    0    0    7    0  879    2    0    2    0]
 [   8    2    0    0    3    1  938    0    6    0]
 [   1    0    8    1    0    0    0 1013    1    4]
 [   3    0    3    1    0    1    0    3  958    5]
 [   5    2    0    4    3    1    0    4    2  988]]
Global Model Test set: Average loss: 0.0473, Accuracy: 0.9833
Precision: 0.9833, Recall: 0.9833, F1 Score: 0.9833
Confusion Matrix:
[[ 974    0    0    0    0    0    3    1    2    0]
 [   0 1124    2    1    0    0    5    0    3    0]
 [   3    3 1006    2    2    0    0   12    4    0]
 [   0    0    1 1002    0    3    0    1    2    1]
 [   0    0    2    0  969    0    3    0    2    6]
 [   2    0    0    5    1  875    4    1    2    2]
 [   3    2    0    1    2    1  946    0    3    0]
 [   1    5    5    2    1    0    0 1007    2    5]
 [   4    1    1    2    3    1    1    3  953    5]
 [   2    5    0    5    9    2    0    6    3  977]]
Global Model Test set: Average loss: 0.0411, Accuracy: 0.9867
Precision: 0.9867, Recall: 0.9867, F1 Score: 0.9867
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1128    3    0    0    1    1    0    2    0]
 [   2    2 1022    1    1    0    0    4    0    0]
 [   0    0    2 1001    0    2    0    3    2    0]
 [   0    0    1    0  968    0    2    0    2    9]
 [   2    0    0    5    0  881    2    0    2    0]
 [   7    3    1    1    3    1  939    0    3    0]
 [   1    2    9    1    0    0    0 1011    2    2]
 [   4    0    3    0    1    1    0    3  958    4]
 [   4    3    0    5    4    0    0    5    3  985]]
Global Model Test set: Average loss: 0.0546, Accuracy: 0.9826
Precision: 0.9827, Recall: 0.9826, F1 Score: 0.9826
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1126    4    1    0    0    2    0    2    0]
 [   2    2 1022    0    1    0    0    5    0    0]
 [   0    0    3  998    0    1    0    5    3    0]
 [   0    0    2    0  970    0    5    0    2    3]
 [   2    0    0    5    0  879    3    1    2    0]
 [   7    3    1    1    1    2  942    0    1    0]
 [   1    3   17    1    0    0    0 1004    1    1]
 [   6    1    5    5    4    2    1    6  943    1]
 [   5    6    0    7   10    2    0    7    3  969]]
Global Model Test set: Average loss: 0.0378, Accuracy: 0.9868
Precision: 0.9868, Recall: 0.9868, F1 Score: 0.9868
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1128    3    0    0    1    1    0    2    0]
 [   2    2 1023    1    1    0    0    3    0    0]
 [   0    0    2 1001    0    2    0    3    2    0]
 [   0    0    1    0  966    0    2    0    2   11]
 [   2    0    0    6    0  880    2    0    2    0]
 [   6    3    0    1    3    3  938    0    4    0]
 [   1    0    8    1    0    0    0 1016    1    1]
 [   4    0    3    0    0    0    1    3  960    3]
 [   5    3    0    4    4    2    0    5    4  982]]
Global Model Test set: Average loss: 0.0439, Accuracy: 0.9847
Precision: 0.9847, Recall: 0.9847, F1 Score: 0.9847
Confusion Matrix:
[[ 972    0    2    0    0    0    2    1    3    0]
 [   0 1125    3    0    0    1    2    0    4    0]
 [   2    2 1021    2    0    0    0    4    1    0]
 [   0    0    2  999    0    3    0    4    2    0]
 [   0    0    2    0  967    0    3    0    3    7]
 [   2    0    0    4    0  880    4    0    2    0]
 [   6    3    1    1    3    3  939    0    2    0]
 [   1    3   10    1    0    0    0 1011    1    1]
 [   4    1    3    2    0    0    1    2  958    3]
 [   4    4    0    6    7    3    0    5    5  975]]
Global Model Test set: Average loss: 0.0331, Accuracy: 0.9886
Precision: 0.9886, Recall: 0.9886, F1 Score: 0.9886
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1129    1    1    0    1    2    0    1    0]
 [   2    0 1026    0    1    0    0    3    0    0]
 [   0    0    2 1002    0    2    0    3    1    0]
 [   0    0    1    0  967    0    3    0    1   10]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    2    0    0    3    3  942    0    2    0]
 [   1    0    6    0    0    0    0 1019    1    1]
 [   4    0    3    0    0    1    0    3  958    5]
 [   5    2    0    4    3    1    0    5    2  987]]
Global Model Test set: Average loss: 0.0343, Accuracy: 0.9885
Precision: 0.9885, Recall: 0.9885, F1 Score: 0.9885
Confusion Matrix:
[[ 974    0    0    0    0    0    2    1    3    0]
 [   0 1128    1    1    0    1    2    1    1    0]
 [   2    1 1024    0    1    0    0    4    0    0]
 [   0    0    2 1003    0    2    0    2    1    0]
 [   0    0    1    0  972    0    3    0    1    5]
 [   2    0    0    6    0  881    3    0    0    0]
 [   5    2    0    0    1    4  945    0    1    0]
 [   1    1    8    0    0    0    0 1016    1    1]
 [   5    1    2    0    0    1    0    3  956    6]
 [   3    3    0    4    3    2    0    5    3  986]]
Global Model Test set: Average loss: 0.0403, Accuracy: 0.9868
Precision: 0.9868, Recall: 0.9868, F1 Score: 0.9868
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1128    3    0    0    1    1    0    2    0]
 [   2    2 1021    1    1    0    0    5    0    0]
 [   0    0    2 1000    0    2    0    4    2    0]
 [   0    0    1    0  968    0    2    0    2    9]
 [   2    0    0    4    0  881    2    1    2    0]
 [   6    3    1    1    3    2  940    0    2    0]
 [   1    1    8    1    0    0    0 1015    1    1]
 [   4    0    3    0    0    0    1    3  960    3]
 [   5    3    0    5    5    2    0    5    3  981]]
Global Model Test set: Average loss: 0.0454, Accuracy: 0.9848
Precision: 0.9848, Recall: 0.9848, F1 Score: 0.9848
Confusion Matrix:
[[ 972    0    2    0    0    0    3    1    2    0]
 [   0 1127    4    0    0    1    1    0    2    0]
 [   2    2 1021    0    1    0    0    5    1    0]
 [   0    0    2 1001    0    1    0    4    2    0]
 [   0    0    2    0  968    0    4    0    2    6]
 [   2    0    0    4    0  879    4    1    2    0]
 [   7    3    1    1    2    3  939    0    2    0]
 [   1    3   10    1    0    0    0 1011    1    1]
 [   5    1    3    3    1    1    1    3  954    2]
 [   4    5    0    5    8    3    0    5    3  976]]
Global Model Test set: Average loss: 0.0364, Accuracy: 0.9886
Precision: 0.9886, Recall: 0.9886, F1 Score: 0.9886
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1128    2    1    0    1    1    0    2    0]
 [   2    1 1024    0    1    0    0    4    0    0]
 [   0    0    2 1002    0    2    0    3    1    0]
 [   0    0    1    0  971    0    2    0    2    6]
 [   2    0    0    5    0  881    2    0    2    0]
 [   6    2    0    0    1    1  946    0    2    0]
 [   1    0    8    0    0    0    0 1017    1    1]
 [   4    0    3    0    0    1    0    3  960    3]
 [   5    2    0    4    5    1    0    5    3  984]]
Global Model Test set: Average loss: 0.0389, Accuracy: 0.9872
Precision: 0.9872, Recall: 0.9872, F1 Score: 0.9872
Confusion Matrix:
[[ 972    0    1    0    0    0    3    1    3    0]
 [   0 1128    3    1    0    0    1    0    2    0]
 [   2    1 1023    0    1    0    0    5    0    0]
 [   0    0    2 1003    0    1    0    3    1    0]
 [   0    0    1    0  970    0    4    0    2    5]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    2    0    0    1    2  945    0    2    0]
 [   1    1   10    0    0    0    0 1014    1    1]
 [   4    1    3    3    1    0    1    4  954    3]
 [   4    4    0    4    7    0    0    6    3  981]]
Global Model Test set: Average loss: 0.0347, Accuracy: 0.9880
Precision: 0.9880, Recall: 0.9880, F1 Score: 0.9880
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1128    2    1    0    1    1    0    2    0]
 [   2    1 1025    0    1    0    0    3    0    0]
 [   0    0    2 1002    0    2    0    3    1    0]
 [   0    0    1    0  968    0    2    0    2    9]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    2    0    0    3    2  942    0    3    0]
 [   1    0    9    0    0    0    0 1016    1    1]
 [   4    0    3    0    0    1    0    3  959    4]
 [   4    2    0    4    5    1    0    5    3  985]]
Global Model Test set: Average loss: 0.0359, Accuracy: 0.9876
Precision: 0.9876, Recall: 0.9876, F1 Score: 0.9876
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1128    1    1    0    1    2    0    2    0]
 [   2    1 1023    0    1    0    0    5    0    0]
 [   0    0    2 1001    0    3    0    3    1    0]
 [   0    0    1    0  970    0    3    0    2    6]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    2    0    0    3    2  943    0    2    0]
 [   1    1    7    0    0    0    0 1017    1    1]
 [   4    1    2    2    0    0    1    3  957    4]
 [   4    3    0    4    5    2    0    5    4  982]]
Global Model Test set: Average loss: 0.0370, Accuracy: 0.9874
Precision: 0.9874, Recall: 0.9874, F1 Score: 0.9874
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1128    3    0    0    1    1    0    2    0]
 [   2    2 1023    0    1    0    0    4    0    0]
 [   0    0    2 1001    0    2    0    3    2    0]
 [   0    0    1    0  970    0    2    0    2    7]
 [   2    0    0    5    0  881    2    0    2    0]
 [   6    3    0    1    3    3  940    0    2    0]
 [   1    0    9    1    0    0    0 1015    1    1]
 [   4    0    3    0    0    0    1    3  960    3]
 [   4    3    0    4    6    1    0    5    3  983]]
Global Model Test set: Average loss: 0.0389, Accuracy: 0.9870
Precision: 0.9870, Recall: 0.9870, F1 Score: 0.9870
Confusion Matrix:
[[ 972    0    1    0    0    0    3    1    3    0]
 [   0 1128    4    0    0    0    1    0    2    0]
 [   2    1 1023    0    1    0    0    5    0    0]
 [   0    0    2 1001    0    2    0    3    2    0]
 [   0    0    1    0  971    0    3    0    2    5]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    3    0    1    2    3  941    0    2    0]
 [   1    1    9    0    0    0    0 1015    1    1]
 [   4    1    3    2    0    0    1    3  957    3]
 [   4    4    0    4    6    3    0    5    3  980]]
Global Model Test set: Average loss: 0.0343, Accuracy: 0.9885
Precision: 0.9885, Recall: 0.9885, F1 Score: 0.9885
Confusion Matrix:
[[ 974    0    0    0    0    0    2    1    3    0]
 [   0 1128    1    1    0    1    2    1    1    0]
 [   2    1 1024    0    1    0    0    4    0    0]
 [   0    0    2 1003    0    2    0    2    1    0]
 [   0    0    1    0  972    0    3    0    1    5]
 [   2    0    0    6    0  881    3    0    0    0]
 [   5    2    0    0    1    4  945    0    1    0]
 [   1    1    8    0    0    0    0 1016    1    1]
 [   5    1    2    0    0    1    0    3  956    6]
 [   3    3    0    4    3    2    0    5    3  986]]
Global Model Test set: Average loss: 0.0473, Accuracy: 0.9833
Precision: 0.9833, Recall: 0.9833, F1 Score: 0.9833
Confusion Matrix:
[[ 974    0    0    0    0    0    3    1    2    0]
 [   0 1124    2    1    0    0    5    0    3    0]
 [   3    3 1006    2    2    0    0   12    4    0]
 [   0    0    1 1002    0    3    0    1    2    1]
 [   0    0    2    0  969    0    3    0    2    6]
 [   2    0    0    5    1  875    4    1    2    2]
 [   3    2    0    1    2    1  946    0    3    0]
 [   1    5    5    2    1    0    0 1007    2    5]
 [   4    1    1    2    3    1    1    3  953    5]
 [   2    5    0    5    9    2    0    6    3  977]]
Global Model Test set: Average loss: 0.0389, Accuracy: 0.9872
Precision: 0.9872, Recall: 0.9872, F1 Score: 0.9872
FigureCanvasAgg is non-interactive, and thus cannot be shown
Confusion Matrix:
[[ 972    0    1    0    0    0    3    1    3    0]
 [   0 1128    3    1    0    0    1    0    2    0]
 [   2    1 1023    0    1    0    0    5    0    0]
 [   0    0    2 1003    0    1    0    3    1    0]
 [   0    0    1    0  970    0    4    0    2    5]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    2    0    0    1    2  945    0    2    0]
 [   1    1   10    0    0    0    0 1014    1    1]
 [   4    1    3    3    1    0    1    4  954    3]
 [   4    4    0    4    7    0    0    6    3  981]]
Global Model Test set: Average loss: 0.0546, Accuracy: 0.9826
Precision: 0.9827, Recall: 0.9826, F1 Score: 0.9826
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1126    4    1    0    0    2    0    2    0]
 [   2    2 1022    0    1    0    0    5    0    0]
 [   0    0    3  998    0    1    0    5    3    0]
 [   0    0    2    0  970    0    5    0    2    3]
 [   2    0    0    5    0  879    3    1    2    0]
 [   7    3    1    1    1    2  942    0    1    0]
 [   1    3   17    1    0    0    0 1004    1    1]
 [   6    1    5    5    4    2    1    6  943    1]
 [   5    6    0    7   10    2    0    7    3  969]]
Global Model Test set: Average loss: 0.0359, Accuracy: 0.9876
Precision: 0.9876, Recall: 0.9876, F1 Score: 0.9876
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1128    1    1    0    1    2    0    2    0]
 [   2    1 1023    0    1    0    0    5    0    0]
 [   0    0    2 1001    0    3    0    3    1    0]
 [   0    0    1    0  970    0    3    0    2    6]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    2    0    0    3    2  943    0    2    0]
 [   1    1    7    0    0    0    0 1017    1    1]
 [   4    1    2    2    0    0    1    3  957    4]
 [   4    3    0    4    5    2    0    5    4  982]]
Global Model Test set: Average loss: 0.0439, Accuracy: 0.9847
Precision: 0.9847, Recall: 0.9847, F1 Score: 0.9847
Confusion Matrix:
[[ 972    0    2    0    0    0    2    1    3    0]
 [   0 1125    3    0    0    1    2    0    4    0]
 [   2    2 1021    2    0    0    0    4    1    0]
 [   0    0    2  999    0    3    0    4    2    0]
 [   0    0    2    0  967    0    3    0    3    7]
 [   2    0    0    4    0  880    4    0    2    0]
 [   6    3    1    1    3    3  939    0    2    0]
 [   1    3   10    1    0    0    0 1011    1    1]
 [   4    1    3    2    0    0    1    2  958    3]
 [   4    4    0    6    7    3    0    5    5  975]]
Global Model Test set: Average loss: 0.0331, Accuracy: 0.9886
Precision: 0.9886, Recall: 0.9886, F1 Score: 0.9886
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1129    1    1    0    1    2    0    1    0]
 [   2    0 1026    0    1    0    0    3    0    0]
 [   0    0    2 1002    0    2    0    3    1    0]
 [   0    0    1    0  967    0    3    0    1   10]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    2    0    0    3    3  942    0    2    0]
 [   1    0    6    0    0    0    0 1019    1    1]
 [   4    0    3    0    0    1    0    3  958    5]
 [   5    2    0    4    3    1    0    5    2  987]]
Global Model Test set: Average loss: 0.0375, Accuracy: 0.9867
Precision: 0.9867, Recall: 0.9867, F1 Score: 0.9867
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1128    2    1    0    1    1    0    2    0]
 [   2    1 1025    1    1    0    0    2    0    0]
 [   0    0    2 1000    0    3    0    3    1    1]
 [   0    0    1    0  964    0    2    0    1   14]
 [   2    0    0    7    0  879    2    0    2    0]
 [   8    2    0    0    3    1  938    0    6    0]
 [   1    0    8    1    0    0    0 1013    1    4]
 [   3    0    3    1    0    1    0    3  958    5]
 [   5    2    0    4    3    1    0    4    2  988]]
Global Model Test set: Average loss: 0.0389, Accuracy: 0.9870
Precision: 0.9870, Recall: 0.9870, F1 Score: 0.9870
Confusion Matrix:
[[ 972    0    1    0    0    0    3    1    3    0]
 [   0 1128    4    0    0    0    1    0    2    0]
 [   2    1 1023    0    1    0    0    5    0    0]
 [   0    0    2 1001    0    2    0    3    2    0]
 [   0    0    1    0  971    0    3    0    2    5]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    3    0    1    2    3  941    0    2    0]
 [   1    1    9    0    0    0    0 1015    1    1]
 [   4    1    3    2    0    0    1    3  957    3]
 [   4    4    0    4    6    3    0    5    3  980]]
Global Model Test set: Average loss: 0.0454, Accuracy: 0.9848
Precision: 0.9848, Recall: 0.9848, F1 Score: 0.9848
Confusion Matrix:
[[ 972    0    2    0    0    0    3    1    2    0]
 [   0 1127    4    0    0    1    1    0    2    0]
 [   2    2 1021    0    1    0    0    5    1    0]
 [   0    0    2 1001    0    1    0    4    2    0]
 [   0    0    2    0  968    0    4    0    2    6]
 [   2    0    0    4    0  879    4    1    2    0]
 [   7    3    1    1    2    3  939    0    2    0]
 [   1    3   10    1    0    0    0 1011    1    1]
 [   5    1    3    3    1    1    1    3  954    2]
 [   4    5    0    5    8    3    0    5    3  976]]
Global Model Test set: Average loss: 0.0364, Accuracy: 0.9886
Precision: 0.9886, Recall: 0.9886, F1 Score: 0.9886
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1128    2    1    0    1    1    0    2    0]
 [   2    1 1024    0    1    0    0    4    0    0]
 [   0    0    2 1002    0    2    0    3    1    0]
 [   0    0    1    0  971    0    2    0    2    6]
 [   2    0    0    5    0  881    2    0    2    0]
 [   6    2    0    0    1    1  946    0    2    0]
 [   1    0    8    0    0    0    0 1017    1    1]
 [   4    0    3    0    0    1    0    3  960    3]
 [   5    2    0    4    5    1    0    5    3  984]]
Global Model Test set: Average loss: 0.0411, Accuracy: 0.9867
Precision: 0.9867, Recall: 0.9867, F1 Score: 0.9867
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1128    3    0    0    1    1    0    2    0]
 [   2    2 1022    1    1    0    0    4    0    0]
 [   0    0    2 1001    0    2    0    3    2    0]
 [   0    0    1    0  968    0    2    0    2    9]
 [   2    0    0    5    0  881    2    0    2    0]
 [   7    3    1    1    3    1  939    0    3    0]
 [   1    2    9    1    0    0    0 1011    2    2]
 [   4    0    3    0    1    1    0    3  958    4]
 [   4    3    0    5    4    0    0    5    3  985]]
Global Model Test set: Average loss: 0.0347, Accuracy: 0.9880
Precision: 0.9880, Recall: 0.9880, F1 Score: 0.9880
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1128    2    1    0    1    1    0    2    0]
 [   2    1 1025    0    1    0    0    3    0    0]
 [   0    0    2 1002    0    2    0    3    1    0]
 [   0    0    1    0  968    0    2    0    2    9]
 [   2    0    0    4    0  882    2    0    2    0]
 [   6    2    0    0    3    2  942    0    3    0]
 [   1    0    9    0    0    0    0 1016    1    1]
 [   4    0    3    0    0    1    0    3  959    4]
 [   4    2    0    4    5    1    0    5    3  985]]
Global Model Test set: Average loss: 0.0378, Accuracy: 0.9868
Precision: 0.9868, Recall: 0.9868, F1 Score: 0.9868
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1128    3    0    0    1    1    0    2    0]
 [   2    2 1023    1    1    0    0    3    0    0]
 [   0    0    2 1001    0    2    0    3    2    0]
 [   0    0    1    0  966    0    2    0    2   11]
 [   2    0    0    6    0  880    2    0    2    0]
 [   6    3    0    1    3    3  938    0    4    0]
 [   1    0    8    1    0    0    0 1016    1    1]
 [   4    0    3    0    0    0    1    3  960    3]
 [   5    3    0    4    4    2    0    5    4  982]]
Global Model Test set: Average loss: 0.0370, Accuracy: 0.9874
Precision: 0.9874, Recall: 0.9874, F1 Score: 0.9874
Confusion Matrix:
[[ 973    0    1    0    0    0    2    1    3    0]
 [   0 1128    3    0    0    1    1    0    2    0]
 [   2    2 1023    0    1    0    0    4    0    0]
 [   0    0    2 1001    0    2    0    3    2    0]
 [   0    0    1    0  970    0    2    0    2    7]
 [   2    0    0    5    0  881    2    0    2    0]
 [   6    3    0    1    3    3  940    0    2    0]
 [   1    0    9    1    0    0    0 1015    1    1]
 [   4    0    3    0    0    0    1    3  960    3]
 [   4    3    0    4    6    1    0    5    3  983]]
Global Model Test set: Average loss: 0.0403, Accuracy: 0.9868
Precision: 0.9868, Recall: 0.9868, F1 Score: 0.9868
Confusion Matrix:
[[ 974    0    1    0    0    0    1    1    3    0]
 [   0 1128    3    0    0    1    1    0    2    0]
 [   2    2 1021    1    1    0    0    5    0    0]
 [   0    0    2 1000    0    2    0    4    2    0]
 [   0    0    1    0  968    0    2    0    2    9]
 [   2    0    0    4    0  881    2    1    2    0]
 [   6    3    1    1    3    2  940    0    2    0]
 [   1    1    8    1    0    0    0 1015    1    1]
 [   4    0    3    0    0    0    1    3  960    3]
 [   5    3    0    5    5    2    0    5    3  981]]
Shapley Values for round 2: {0: -0.00047499999999997544, 1: 0.0001083333333333491, 2: 0.0017916666666667003, 3: 0.0026750000000000294}
Incentives allocated: {'0': -1158.5365853657645, '1': 264.22764227645456, '2': 4369.918699186964, '3': 6524.390243902346}
Comparing client 0 and global model shap values
Comparing client 1 and global model shap values
Comparing client 2 and global model shap values
Comparing client 3 and global model shap values
